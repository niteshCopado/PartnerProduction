<apex:page sidebar="false" standardcontroller="Bread_Winner__Invoice__c" id="pg" extensions="Bread_Winner.CreateInvoiceExtension" cache="true" title="{!IF(showAccountPanel, IF(isEditAccount, 'Edit Xero Contact', 'Create a Xero Contact'), 'Select Xero Contact')}" action="{!invoicefromcustomobj}">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <head>            
            <apex:slds />
            <meta charset="utf-8" />
            <apex:variable value="{!OR($User.UIThemeDisplayed == 'Theme4d', $User.UIThemeDisplayed == 'Theme4t')}" var="isLightning" />
            <script src="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/JS/jquery-1.11.3.js')}" />
            <script>    
            $(document).keydown (
                            function(event){
                            var code = event.keyCode || event.which;
                            if (code == 27) {
                                closeModal();
                            }
                        });            
            if(document.getElementsByTagName("title") && document.getElementsByTagName("title")[0]){                
                if(document.getElementsByTagName("title")[0].innerText.includes("Create a Xero Contact")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Create a Xero Contact';
                }
                if(document.getElementsByTagName("title")[0].innerText.includes("Select Xero Contact")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Select Xero Contact';
                }
                if(document.getElementsByTagName("title")[0].innerText.includes("Edit Xero Contact")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Edit Xero Contact';
                }                               
            }
            var j$ = jQuery.noConflict();
            function HideStyleSheet() {
                j$("link.user[href$='elements.css']").each(function() {
                    j$(this).removeAttr("href");
                });
            }
            function message() {
                j$(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify_alert slds-theme_info slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block","background-color":"rgba(84,105,141,.95)","border-color":"rgba(84,105,141,.95)"});
                j$(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify_alert slds-theme_error slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block"});
                j$(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify_alert slds-theme_warning slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block"} ) ;
                j$(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify_alert slds-theme_success slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","display":"block"} ) ;
                
                j$("div .messageText h4").css( "color", "white" );
                j$("div[class*='warning'] div.messageText h4").css( "color", "black" );
                j$("table.messageTable td").css({"color" : "white"});
                j$("div[class*='warning'] table.messageTable td").css( "color", "black" );                
            }
            j$(function() {
                HideStyleSheet();
                message();
                refreshTotalPage();
            });
            function identifyfield(elementt, helptext, TopMinusparam,LeftMinusParam) {
                var x = j$(elementt).offset();
                var islightningparam='{!isLightning}';
                if(islightningparam=='true'){
                    LeftMinusParam=LeftMinusParam-9;
                    TopMinusparam=TopMinusparam-105;
                }
                var ToSetleft = x.left - LeftMinusParam;
                j$("#help p").text(helptext);
                var ToSetheight = x.top - TopMinusparam;
                var heptextdiv = document.getElementById("help");
                j$(heptextdiv).css({
                    top: ToSetheight + 'px',
                    left: ToSetleft + 'px',
                    display: ""
                })
            }
            function mouseoutclose() {
                var heptextdiv = document.getElementById("help");
                j$(heptextdiv).css({
                    top: "0px",
                    left: "0px",
                    display: "none"
                });
            }
            function renderMoneyBagSVG(){
                var imageURL = '{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#moneybag')}';
                var SVG = j$('<svg/>', {
                   class: 'slds-icon slds-icon-standard-user',
                });

                var SVGUse = j$('<use/>');
                SVGUse.attr('xlink:href',imageURL);
                j$('#Icon').prepend(SVG.append(SVGUse));
                j$('#Icon' ).html(j$('#Icon').html());
            }
            function reRenderAccountSVG(){
                var imageURL = '{!URLFOR($Asset.SLDS, 'assets/icons/standard-sprite/svg/symbols.svg#account')}';
                var SVG = j$('<svg/>', {
                    class: 'slds-icon slds-icon-standard-user',
                });
                
                var SVGUse = j$('<use/>');
                SVGUse.attr('xlink:href',imageURL);
                j$('#accountIcon').prepend(SVG.append(SVGUse));
                j$('#accountIcon' ).html(j$('#accountIcon').html());
            }
            function reRenderCloseSVG(){
                var imageURL = '{!URLFOR($Asset.SLDS, 'assets/icons/action-sprite/svg/symbols.svg#close')}';
                var SVG = j$('<svg/>', {class: 'slds-button__icon slds-button__icon_large',});
                var SVGUse = j$('<use/>');
                SVGUse.attr('xlink:href',imageURL);
                j$('#closeIcon').prepend(SVG.append(SVGUse));
                j$('#closeIcon').html(j$('#closeIcon').html());
            }
            function reRenderCheckSVG(pathID){
                var imageURL = '{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}';
                var SVG = j$('<svg/>', {class: 'slds-icon slds-icon_x-small',});
                var SVGUse = j$('<use/>');
                SVGUse.attr('xlink:href',imageURL);
                j$(pathID).prepend(SVG.append(SVGUse));
                j$(pathID).html(j$(pathID).html());
            }
            function showModal(){
                j$('#modal').show();
                reRenderCloseSVG();
            }
            function closeModal(){
                j$('#modal').hide();
            }
            function showspinner(type){
                if(type == 'withtext'){
                    j$('#spinnerForReparent').show();
                }
                else{
                    j$('#spinnerId').show();
                }
            }
            function hidespinner(type){
                if(type == 'withtext'){
                    j$('#spinnerForReparent').hide();
                }
                else{
                    j$('#spinnerId').hide();
                }
            }
            </script>
            <style>
                table.messageTable td img{
                display: none;
                }
                .message {
                background-color: inherit;
                border-style: none;
                padding: initial;
                margin-left: 0px !important;
                margin-right: 0px !important;
                }
                .msgIcon {
                display: none;
                }                
                .message .messageText h4 {
                font-weight: inherit;
                display: initial;
                }
                .slds-scope table {
                width: initial;
                }
                .slds-scope .slds-page-header__detail-row {
                margin: initial;
                padding-left: 2rem;
                }
                .slds-scope .slds-radio .slds-form-element__label {
                font-size: 1.15em;
                }
                .slds-scope .slds-page-header__detail-block {
                max-width: inherit;
                width: 15%;
                }
                .slds-scope .slds-spinner_container{
                position: fixed; z-index: 9999;
                }
                .slds-spinner-displaytext {
                position: absolute; top: 58%;
                width: 100%;text-align: center;font-size: 1.4em;
                }
                .slds-scope .slds-notify.slds-theme_warning a:not(.slds-button_neutral):hover,
                .slds-scope .slds-notify.slds-theme_warning a:not(.slds-button_neutral):link, 
                .slds-scope .slds-notify.slds-theme_warning a:not(.slds-button_neutral):visited {
                color: black !important;
                }
                /* Arrow Path styles start */
                .slds-scope .slds-path__nav .slds-is-complete, .slds-scope .slds-path__nav .slds-is-complete:before, .slds-scope .slds-path__nav .slds-is-complete:after {
                background: rgb(75, 202, 129);
                }
                .slds-scope .slds-path__nav .slds-is-active, .slds-scope .slds-path__nav .slds-is-active:before, .slds-scope .slds-path__nav .slds-is-active:after {
                background: rgb(0, 95, 178);
                }
                .slds-scope .slds-path__nav .slds-is-incomplete, .slds-scope .slds-path__nav .slds-is-incomplete:before, .slds-scope .slds-path__nav .slds-is-incomplete:after {
                background: rgb(236, 235, 234);
                }
                .slds-scope .slds-path__nav .slds-is-complete:hover, .slds-scope .slds-path__nav .slds-is-complete:hover:before, .slds-scope .slds-path__nav .slds-is-complete:hover:after{
                background: rgb(4, 132, 75);
                }
                .slds-scope .slds-path__nav .slds-is-active:hover, .slds-scope .slds-path__nav .slds-is-active:hover:before, .slds-scope .slds-path__nav .slds-is-active:hover:after{
                background: rgb(0, 57, 107);
                }
                .slds-scope .slds-path__nav .slds-is-incomplete:hover, .slds-scope .slds-path__nav .slds-is-incomplete:hover:before, .slds-scope .slds-path__nav .slds-is-incomplete:hover:after {
                background: rgb(221, 219, 218);
                }
                .slds-scope .slds-path__nav :hover{
                    cursor:default !important;
                }
                /* Arrow Path styles end */
                .slds-template_default{
                    padding: 0px !important;
                }
                /*Edit Xero Contact page Arrow styles  */
                .arrow {
                    font-size: 25px;
                    color: #42B7F4;
                }
                .arrowLink{
                    text-decoration:none !important;
                }
                .slds-spinner.slds-spinner_x-small.slds-spinner_brand.arrowSpinner{
                    top: inherit !important;
                    left: inherit !important;
                    transform: translate(200%, 0%) rotate(90deg) !important;
                }
            </style>
        </head>
        <body >
            <div class="slds-scope" style="background-color: white !important;">
            <apex:form ><apex:actionFunction name="deleteMDfield" action="{!deleteMasterDetailFieldIfExists}" rerender="nothing"/></apex:form>            
            <apex:outputPanel id="wholeBody" layout="block" styleClass="{!IF(isLightning,'slds-p-around_x-small','')}">
                <!-- ----------------------------------- fields level help ---------------------------------- -->
                <div id="help" class="slds-popover slds-popover_tooltip slds-nubbin_bottom-left" role="tooltip" aria-live="polite" style="display:none;position:absolute;top:0px;left:0px;">
                    <div class="slds-popover__body slds-text-longform">
                        <p>Help text will come here dynamically</p>
                    </div>
                </div>
                <!-- ----------------------------------- fields level help ---------------------------------- -->
                <apex:form rendered="{!AND(subscribeBreadwinner, !isFreePlan)}">
                    <apex:outputPanel layout="block" styleClass="warningM3" style="border-radius:4px;">
                        <b> Your Trial has Expired </b>
                        <br/>
                        <apex:outputLabel value="You must have a valid subscription to Breadwinner to create and sync Invoices."></apex:outputLabel>
                        <apex:outputLabel rendered="{!AND(NOT(isSandbox),NOT(isDeveloperEdition))}" value="Please contact your Account Executive."></apex:outputLabel>
                        <apex:outputLabel rendered="{!OR(isSandbox,isDeveloperEdition)}" value="Please visit the Breadwinner tab for more info."></apex:outputLabel>
                    </apex:outputPanel>
                </apex:form>
                <apex:form id="theForm" rendered="{!OR(!subscribeBreadwinner, isFreePlan)}">
                    <apex:actionStatus id="assign-action-status" layout="block">
                        <apex:facet name="start">
                            <div class="slds-spinner_container">
                                <div class="slds-spinner_brand slds-spinner slds-spinner_medium" role="alert">
                                    <span class="slds-assistive-text">Loading</span>
                                    <div class="slds-spinner__dot-a"></div>
                                    <div class="slds-spinner__dot-b"></div>
                                </div>
                            </div>
                        </apex:facet>
                    </apex:actionStatus>
                     <div id="spinnerId" class="slds-spinner_container" style="display: none;">
                        <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>

                    <apex:actionFunction name="refreshTotalPage" status="assign-action-status" rerender="mainPanel,messagesPanel" oncomplete="HideStyleSheet();message();renderMoneyBagSVG();reRenderCheckSVG('#choosenStage1');reRenderCheckSVG('#choosenStage2');reRenderCheckSVG('#selectBACStage');reRenderCheckSVG('#choosenSupplier');reRenderAccountSVG();"/>

                     <apex:actionFunction name="NewInvoiceType" status="assign-action-status" rerender="headerPanel,newInvoicePanel" oncomplete="HideStyleSheet();message();renderMoneyBagSVG();reRenderCheckSVG('#choosenStage1');reRenderCheckSVG('#choosenSupplier');">
                        <apex:param value="" name="myParam" assignto="{!Invoice_Type}" />
                    </apex:actionFunction>

                    <apex:pageMessages escape="false" rendered="{!OR(isActiveOrganization, AND(isFreePlan, !InvoiceFromOrder, !InvoiceFromBillingEvent, !InvoicefromURL, !LIfromoriginatingobj))}"></apex:pageMessages>                    
                    <apex:outputPanel layout="block" id="messagesPanel">
                        <apex:pageMessage rendered="{!notInitializedWithAccount && !InvoiceFromOrder && !BillorPOfromMPB && NOT(InvoicefromURL || LIfromoriginatingobj || InvoiceFromBillingEvent)}" summary="Please go to the Account or Opportunity from which you want to create this new Invoice." detail="If that Account doesn't exist yet, please create it first." severity="Warning" strength="3" />
                        <apex:pagemessage rendered="{!isActiveOrganization && IF(InvoiceFromBillingEvent,IF(isBillingEventNotInitializedWithAccount,If(isProfessionalorHigher,True,False), False),False)}" summary="You are trying to create an Invoice from Billing Event object, but the record from which you are creating the Invoice is missing information. We expect a Salesforce Account to be specified in the field Account. However, this field appears to be blank or incorrect. Please check the record and make sure this field is populated properly." severity="Warning" strength="3"></apex:pagemessage>
                        <apex:pageMessage rendered="{!isActiveOrganization && (notInitializedWithAccount && (InvoicefromURL || LIfromoriginatingobj)&& isEnterprise)}" escape="false" summary="{!AccountNotExistErrormessage}" detail="" severity="Warning" strength="3" />
                        <apex:pageMessage rendered="{!Invoice_from_Lead}" summary="Sorry, You can not create Invoices from Leads." detail="This is because once the Lead is converted it is no longer accessible through the User Interface." severity="Warning" strength="3" />              
                        <apex:pagemessage rendered="{!isActiveOrganization && !isEnterprise && (parentid!=null) && (InvoicefromURL || LIfromoriginatingobj) && Invoice_type=='invoice'}" summary="You must be on a higher plan to create an Invoice using {!IF(LIfromoriginatingobj, 'Custom URL Line Items', 'Custom URL')}." severity="error" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!AND(isActiveOrganization, isAccountsPayableEnabled, NOT(isEnterprise), OR(InvoicefromURL,LIfromoriginatingobj), OR(Invoice_type=='bill',Invoice_type=='purchaseorder'), NOT(InvForBills), parentid!=null)}" summary="You must be on a higher plan to create a {!Invoice_Type_Label} using {!IF(LIfromoriginatingobj, 'Custom URL Line Items', 'Custom URL')}." severity="error" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!isActiveOrganization && InvoiceFromOrder && !isProfessionalorHigher && NOT(ISBLANK(xeroOrgID))}" summary="You must be on a higher plan to create an Invoice from Order." severity="Warning" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!isActiveOrganization && InvoiceFromBillingEvent && !isProfessionalorHigher && NOT(ISBLANK(xeroOrgID))}" summary="You must be on a higher plan to create an Invoice from Billing Event." severity="Warning" strength="3"></apex:pagemessage>
                        <apex:pagemessage severity="error" summary="You must have Accounts Payable module enabled to create a {!Invoice_Type_Label}. For more details, please contact sales@breadwinner.com" rendered="{!AND(isActiveOrganization, OR(Invoice_type=='bill',Invoice_type=='purchaseorder'), NOT(isAccountsPayableEnabled))}" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!isFreePlan && (InvoiceFromOrder || InvoiceFromBillingEvent)}" summary="You are on Breadwinner's Free Plan. You must have an active subscription to create an Invoice from {!IF(InvoiceFromBillingEvent, 'Billing Event', 'Order')}. For more details, please contact sales@breadwinner.com" severity="Warning" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!isFreePlan && (InvoicefromURL || LIfromoriginatingobj)}" summary="You are on Breadwinner's Free Plan. You must have an active subscription to create {!IF(Invoice_type=='invoice', 'an', 'a')} {!Invoice_Type_Label} using {!IF(LIfromoriginatingobj, 'Custom URL Line Items', 'Custom URL')}. For more details, please contact sales@breadwinner.com" severity="Warning" strength="3"></apex:pagemessage>
                        <apex:pagemessage rendered="{!isFreePlan && (BillorPOfromMPB || Invoice_Type=='bill' || Invoice_Type=='purchaseorder') && !InvoiceFromBillingEvent && !InvoiceFromOrder && !LIfromoriginatingobj && !InvoicefromURL}" summary="You are on Breadwinner's Free Plan. You must have an active subscription to create {!IF(Invoice_type=='invoice', 'an', 'a')} {!Invoice_Type_Label}. For more details, please contact sales@breadwinner.com" severity="Warning" strength="3"></apex:pagemessage>
                        
                        <apex:pagemessage severity="warning" summary="You can not Pre-populate {!Invoice_Type_Label} Line Items from Opportunity Products until you have finished configuring the {!Invoice_Type_Label} Configuration section in the Breadwinner tab" rendered="{!AND(DoneBWSetupforBillPO, !isFreePlan, isAccountsPayableEnabled)}" strength="3"></apex:pagemessage>
                        <apex:outputPanel rendered="{!isMasterDetailFieldExist}" styleClass="slds-notify slds-notify_alert slds-theme_error slds-text-align_left slds-text-heading_medium slds-m-bottom_small" style="font-weight: 500; line-height: 1.4; word-spacing: 1px; justify-content: left; border-radius: 4px;">
                            <apex:outputPanel >Before you create any more Invoices, you will need to make one quick change in your Salesforce instance. Please ask a Salesforce Admin to go to <a href="https://help-xero.breadwinner.com/support/solutions/articles/44001337138" target="_blank">this help page</a>, delete a single Breadwinner field, and you will be able to continue creating Invoices. If you have any questions, please <a href="https://help-xero.breadwinner.com/support/tickets/new" target="_blank">file a case here</a>.</apex:outputPanel>
                        </apex:outputPanel>
                        <div class="slds-box slds-box_x-small slds-theme_alt-inverse" style="{!IF(showMultiTenantMessage && initialized, 'display:block', 'display:none')}" >
                            <div class="slds-text-heading_small"><p>{!MultiTenantAlertMessage}</p></div>
                        </div>
                    </apex:outputPanel>
                    
                    <apex:outputPanel id="mainPanel" rendered="{!initialized}" layout="block">
                        <!--- Select Invoice Type, Products, Suppleirs and BAC Section Start -->
                        <apex:outputPanel id="dispalyInvoicePanel" layout="block" rendered="{!dispalyInvoicePanel}">
                            <apex:pagemessage severity="error" summary="No Suppliers exist on the Opportunity Products, please add a Supplier Account and try again." rendered="{!AND(isAccountsPayableEnabled, POforBusinessOrg, ShowBissinessPoPanel, OR(NOT(opportunityHaveProducts), NOT(Suppliers.size>1)))}" strength="3"></apex:pagemessage>
                            <apex:pagemessage severity="warning" summary="Your Salesforce User / Profile does not have the required permissions to create an Invoice.<br/>This is easily resolved, please ask your Salesforce Administrator to give Create and Edit permissions on Xero Contacts object at the User Profile." escape="false" rendered="{!havePermissionsIssue}"></apex:pagemessage>
                            <apex:outputPanel layout="block" id="headerPanel" rendered="{!AND(OR(showInvoicePanel, Suppliers.size>1), Createcon)}">
                                <!-- ---------------------------------- Header Start --------------------------- -->
                                <div class="slds-page-header" role="banner" style="background: #f7f9fb;">
                                    <div class="slds-media">
                                        <div class="slds-media__figure" id="Icon">
                                            <svg aria-hidden="true" class="slds-icon slds-icon-standard-user">
                                                <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#moneybag')}"></use>
                                            </svg>
                                        </div>
                                        <div class="slds-media__body">
                                            <p class="slds-page-header__title slds-truncate" title="New Breadwinner Xero {!Invoice_Type_Label}"> New Xero {!Invoice_Type_Label} </p>
                                            <p class="slds-text-body_small">Breadwinner â€¢ Xero </p>
                                        </div>
                                    </div>
                                </div>
                                <!-- ---------------------------------- Header end ----------------------------- -->

                                <apex:outputPanel layout="block" id="pathPanel">
                                    <div class="slds-path slds-m-top_x-small slds-m-bottom_x-small">
                                        <div class="slds-grid slds-path__track">
                                            <div class="slds-grid slds-path__scroller-container">
                                                <div class="slds-path__scroller" role="application">
                                                    <div class="slds-path__scroller_inner">
                                                        <ul class="slds-path__nav" role="listbox" aria-orientation="horizontal">
                                                            <li class="slds-path__item slds-is-complete" role="presentation">
                                                                <span class="slds-path__link">
                                                                    <span class="slds-path__stage" id="choosenStage1">
                                                                        <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                        </svg>
                                                                        <span class="slds-assistive-text">Chosen {!IF(NOT(ISBLANK(ParentobjectName)),ParentobjectName,IF(InvoiceFromOrder, 'Order',IF(NOT(ISBLANK(sfInvoice.Opportunity__c)),'Opportunity',IF(InvoiceFromBillingEvent, 'Billing Event', 'Account'))))}</span>
                                                                    </span>
                                                                    <span class="slds-path__title">Chosen {!IF(NOT(ISBLANK(ParentobjectName)),ParentobjectName,IF(InvoiceFromOrder, 'Order',IF(NOT(ISBLANK(sfInvoice.Opportunity__c)),'Opportunity',IF(InvoiceFromBillingEvent, 'Billing Event','Account'))))}</span>
                                                                </span>
                                                            </li>
                                                            <li class="slds-path__item {!IF(LEN(selectedSupplier)>1,'slds-is-complete','slds-is-active slds-is-current')}" role="presentation" style="display:{!IF(AND(OR(BillorPOfromMPB,InvoicefromURL),Suppliers.size>1),'','none')}">
                                                                <span class="slds-path__link">
                                                                    <span class="slds-path__stage" id="choosenSupplier">
                                                                        <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                        </svg>
                                                                        <span class="slds-assistive-text">Select Supplier</span>
                                                                    </span>
                                                                    <span class="slds-path__title">Select Supplier</span>
                                                                </span>
                                                            </li>
                                                            <li class="slds-path__item {!IF(AND(OR(BillorPOfromMPB,InvoicefromURL),Suppliers.size>1),IF(LEN(selectedSupplier)>1,'slds-is-active slds-is-current','slds-is-incomplete'),'slds-is-active slds-is-current')}" role="presentation">
                                                                <span class="slds-path__link">
                                                                    <span class="slds-path__stage">
                                                                        <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                        </svg>
                                                                        <span class="slds-assistive-text">Select Xero Contact</span>
                                                                    </span>
                                                                    <span class="slds-path__title">Select Xero Contact</span>
                                                                </span>
                                                            </li>
                                                            <li class="slds-path__item slds-is-incomplete" role="presentation" style="display:{!IF(OR(AND(OR(BillorPOfromMPB,InvoicefromURL),LEN(selectedSupplier)>1,selectedXeroAccount=='createNewXeroAccount'),AND(NOT(OR(BillorPOfromMPB,InvoicefromURL)),selectedXeroAccount=='createNewXeroAccount'),AND(BillorPOfromMPB,LEN(parentid)<1,selectedXeroAccount=='createNewXeroAccount'),AND(NOT(BillorPOfromMPB),InvoicefromURL,selectedXeroAccount=='createNewXeroAccount')),'','none')}">
                                                                <span class="slds-path__link">
                                                                    <span class="slds-path__stage">
                                                                        <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                        </svg>
                                                                        <span class="slds-assistive-text">Create a Xero Contact</span>
                                                                    </span>
                                                                    <span class="slds-path__title">Create a Xero Contact</span>
                                                                </span>
                                                            </li>
                                                            <li class="slds-path__item slds-is-incomplete" role="presentation">
                                                                <span class="slds-path__link">
                                                                    <span class="slds-path__stage">
                                                                        <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                        </svg>
                                                                        <span class="slds-assistive-text">Create a Xero {!Invoice_Type_Label}</span>
                                                                    </span>
                                                                    <span class="slds-path__title">Create a Xero {!Invoice_Type_Label}</span>
                                                                </span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        
                            <apex:outputPanel layout="block" styleclass="slds-m-bottom_large" rendered="{!AND(POforBusinessOrg, Suppliers.size>1, ShowBissinessPoPanel)}">
                                <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using Opportunity Products</h3>
                                <script>
                                function oppselect(inputvalue) {
                                    document.getElementById('{!JSENCODE($Component.theForm.OppSelectId)}').value = inputvalue;
                                }
                                </script>
                                <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                    <div class="slds-form-element__control">
                                        <label class="slds-radio">
                                            <input type="radio" name="oppoptions" id="DoNotUse" onclick="oppselect('DoNotUse');" />
                                            <span class="slds-radio_faux"></span>
                                            <span class="slds-form-element__label">Blank {!Invoice_Type_Label}</span>
                                        </label>
                                        <label class="slds-radio slds-m-top_x-small">
                                            <apex:outputPanel rendered="{!NOT(AND(POforBusinessOrg, OR(NOT(opportunityHaveProducts), NOT(Suppliers.size>1))))}">
                                                <input type="radio" name="oppoptions" id="UseProducts" onclick="oppselect('UseProducts');" />
                                                <span class="slds-radio_faux"></span>
                                                <span class="slds-form-element__label">{!IF(AND(opportunityHaveProducts,Suppliers.size>1),'Pre-Populate '+Invoice_Type_Label+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}</span>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!AND(POforBusinessOrg, OR(NOT(opportunityHaveProducts), NOT(Suppliers.size>1)))}">
                                                <input type="radio" name="oppoptions" id="UseProducts" onclick="oppselect('UseProducts');" disabled="disabled" />
                                                <span class="slds-radio_faux"></span>
                                                <span class="slds-form-element__label">{!IF(AND(opportunityHaveProducts,Suppliers.size>1),'Pre-Populate '+Invoice_Type_Label+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}</span>
                                            </apex:outputPanel>
                                        </label>
                                    </div>
                                </fieldset>
                                <apex:inputHidden id="OppSelectId" value="{!UseOpportunityProducts}" />
                                <script>
                                document.getElementById('{!JSENCODE(UseOpportunityProducts)}').checked = true;
                                </script>
                            </apex:outputPanel>
                            
                            <apex:outputPanel layout="block" styleClass="slds-m-bottom_large" rendered="{!AND(Suppliers.size>1, BillsSection)}">
                                <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using Suppliers</h3>
                                <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_medium slds-m-left_medium">
                                    <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Choose Supplier</span>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectlist value="{!selectedSupplier}" size="1" styleClass="slds-select" id="suppliersList"
                                                    >
                                                        <apex:actionSupport event="onchange" action="{!SupplierDetails}" status="assign-action-status" reRender="theForm" oncomplete="HideStyleSheet();message();renderMoneyBagSVG();reRenderCheckSVG('#choosenStage1');reRenderCheckSVG('#choosenSupplier');" />
                                                        <apex:selectOptions value="{!Suppliers}"></apex:selectOptions>
                                                    </apex:selectlist>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>
                            
                            <apex:outputpanel layout="block" id="NewInvoiceselection" styleClass="slds-m-bottom_large" rendered="{!AND(OR(BillsEnabled, POsEnabled), isAccountsPayableEnabled, showInvoicePanel, !InvoicefromURL, !InvoiceFromOrder, !InvoiceFromBillingEvent, !POforBusinessOrg, !isFreePlan)}">
                                <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Are you creating an Invoice{!if(BillsEnabled && POsEnabled, ', Bill', if(BillsEnabled, ' or Bill' , ''))}{!if(POsEnabled, ' or Purchase Order','')}?</h3>
                                <table class="slds-m-left_medium slds-m-top_medium">
                                    <tr>
                                        <td style="display:{!IF(InvForBills==false ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType1" value="invoice" checked="checked" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Invoice</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style="display:{!IF(((InvForBills==true && !BillorPOfromMPB && POsEnabled ) || (BillorPOfromMPB && Invoice_type=='purchaseorder')) ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType2" value="invoice" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Invoice</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style="display:{!IF((BillorPOfromMPB && Invoice_type=='bill')|| (!PosEnabled  && Invoice_type=='bill'),'','none') };">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType3" value="invoice" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Invoice</span>
                                                </label>
                                            </div>
                                        </td>
                                        
                                        <td style=" display:{!IF(BillsEnabled && InvForBills==false ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType1" value="bill" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Bill</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style=" display:{!IF(AND((BillsEnabled && ((InvForBills==true && NOT(BillorPOfromMPB)) || (BillorPOfromMPB && Invoice_type=='purchaseorder'))),POsEnabled) ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType2" value="bill" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Bill</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style="display:{!IF(BillsEnabled && (BillorPOfromMPB || !POsEnabled) && Invoice_type=='bill','','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType3" value="bill" checked="checked" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Bill</span>
                                                </label>
                                            </div>
                                        </td>
                                        
                                        <td style=" display:{!IF(POsEnabled && InvForBills==false ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType1" value="purchaseorder" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Purchase Order</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style=" display:{!IF((POsEnabled && ((InvForBills==true && !BillorPOfromMPB) || (BillorPOfromMPB && Invoice_type=='purchaseorder'))) ,'','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType2" value="purchaseorder" checked="checked" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Purchase Order</span>
                                                </label>
                                            </div>
                                        </td>
                                        <td style=" display:{!IF(POsEnabled && BillorPOfromMPB && Invoice_type=='bill','','none')};">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" onclick="NewInvoiceType(this.value);" name="NewInvoiceType3" value="purchaseorder" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Purchase Order</span>
                                                </label>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </apex:outputpanel>
                            
                            <apex:outputPanel id="newInvoicePanel">
                                <apex:outputPanel rendered="{!OR(showInvoicePanel, AND(showInvoicePanel, POforBusinessOrg, NOT(Suppliers.size>1)))}">
                                    <apex:outputPanel layout="block" styleClass="slds-m-bottom_large" rendered="{!AND(opportunityProducts, !POforBusinessOrg,OR(NOT(ISBLANK(sfInvoice.Bread_Winner__Opportunity__c)), NOT(ISBLANK(sfInvoice.Bread_Winner__Opportunity_Bills_PO__c))))}">
                                        <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using Opportunity Products</h3>
                                        <script>
                                        function oppselect2(inputvalue) {
                                            document.getElementById('{!JSENCODE($Component.theForm.OppSelectId2)}').value = inputvalue;
                                        }
                                        </script>
                                        <apex:pageMessage severity="info" strength="3" rendered="{!AND(ISBLANK(sfInvoice.Bread_Winner__Opportunity__c), ISBLANK(InvoiceOrder), ISBLANK(sfInvoice.Bread_Winner__Opportunity_Bills_PO__c))}" summary="Opportunity Products can only be added to an Invoice when clicking 'New Invoice' from that Opportunity."></apex:pageMessage>
                                        
                                        <apex:outputPanel rendered="{!OR(NOT(ISBLANK(sfInvoice.Bread_Winner__Opportunity__c)), NOT(ISBLANK(sfInvoice.Bread_Winner__Opportunity_Bills_PO__c)))}">
                                            <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                                <div class="slds-form-element__control">
                                                    <label class="slds-radio">
                                                        <input type="radio" name="oppoptions2" id="DoNotUse" onclick="oppselect2('DoNotUse')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">Blank {!Invoice_Type_Label}</span>
                                                    </label>
                                                    <label class="slds-radio slds-m-top_x-small">
                                                        <apex:outputPanel rendered="{!AND(NOT(OR(NOT(opportunityHaveProducts),Invoice_Type=='bill', Invoice_Type=='purchaseorder' )), !isFreePlan)}">
                                                            <input type="radio" name="oppoptions2" id="UseProducts" onclick="oppselect2('UseProducts')" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(opportunityHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}
                                                            <apex:outputText rendered="{!AND(opportunityHaveProducts,Partial_Invoice_Enabled)}" >
                                                            <span Class="slds-m-top_large" style="color:#000000;font-size:12px;">(but only those with the field <b><i>{!$ObjectType['OpportunityLineItem'].Fields[Opp_Line_Item_Partial_Invoice].Label}</i></b> checked)</span>
                                                            </apex:outputText></span>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!OR(NOT(opportunityHaveProducts),Invoice_Type=='bill', Invoice_Type=='purchaseorder', isFreePlan)}">
                                                            <input type="radio" name="oppoptions2" id="UseProducts" onclick="oppselect2('UseProducts')" disabled="disabled" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(opportunityHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}</span>
                                                            <apex:outputPanel styleClass="slds-form-element__label" style="color: #54698d; font-size:0.75rem" rendered="{!isFreePlan}">(This feature is only available on paid Breadwinner plans)</apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </label>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                        
                                        <apex:inputHidden id="OppSelectId2" value="{!UseOpportunityProducts}" />
                                        <script>
                                        document.getElementById('{!JSENCODE(UseOpportunityProducts)}').checked = true;
                                        </script>
                                    </apex:outputPanel>
                                    
                                    <!-- ------------------------------- ORDER PRODUCTS -------------------------- -->
                                    <apex:outputPanel layout="block" styleClass="slds-m-bottom_large" rendered="{!AND(orderProducts, !POforBusinessOrg,OR(NOT(ISBLANK(sfInvoice[orderField]))))}">
                                        <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using Order Products</h3>
                                        <script>
                                        function oppselect3(inputvalue) {
                                            document.getElementById('{!JSENCODE($Component.theForm.OppSelectId3)}').value = inputvalue;
                                        }
                                        </script>
                                        <apex:pageMessage severity="info" strength="3" rendered="{!(ISBLANK(sfInvoice[OrderField]))}" summary="Opportunity Products can only be added to an Invoice when clicking 'New Invoice' from that Opportunity."></apex:pageMessage>
                                        
                                        <apex:outputPanel rendered="{!NOT(ISBLANK(sfInvoice[OrderField]))}">
                                            <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                                <div class="slds-form-element__control">
                                                    <label class="slds-radio">
                                                        <input type="radio" name="oppoptions2" id="DoNotUse" onclick="oppselect3('DoNotUse')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">Blank {!Invoice_Type_Label}</span>
                                                    </label>
                                                    <label class="slds-radio slds-m-top_x-small">
                                                        <apex:outputPanel rendered="{!NOT(OR(NOT(orderHaveProducts),Invoice_Type=='bill', Invoice_Type=='purchaseorder' ))}">
                                                            <input type="radio" name="oppoptions2" id="UseProducts" onclick="oppselect3('UseProducts')" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(orderHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with Order Products','(there are no Order Products on this Order)')}</span>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!OR(NOT(orderHaveProducts),Invoice_Type=='bill', Invoice_Type=='purchaseorder' )}">
                                                            <input type="radio" name="oppoptions2" id="UseProducts" onclick="oppselect3('UseProducts')" disabled="disabled" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(orderHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with Order Products','(there are no Order Products on this Order)')}</span>
                                                        </apex:outputPanel>
                                                    </label>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                        
                                        <apex:inputHidden id="OppSelectId3" value="{!UseOrderProducts}" />
                                        <script>
                                        document.getElementById('{!JSENCODE(UseOrderProducts)}').checked = true;
                                        </script>
                                    </apex:outputPanel>
                                    <!-- ---------------------------- END OF ORDER PRODUCTS ----------------------- -->
                                    <!-- Billing Event Item Start -->
                                   
                                    <apex:outputPanel layout="block" styleClass="slds-m-bottom_large" rendered="{!AND(InvoiceFromBillingEvent,NOT(ISBLANK(sfInvoice[billingEventField])))}">
                                        <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using Billing Event Items</h3>
                                        <script>
                                        function BillingEventSelect(inputvalue) {
                                             document.getElementById('{!JSENCODE($Component.theForm.useBillingEventItems)}').value = inputvalue;
                                        }
                                        </script>
                                        <apex:outputPanel rendered="{!NOT(ISBLANK(sfInvoice[billingEventField]))}">
                                            <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                                <div class="slds-form-element__control">
                                                    <label class="slds-radio">
                                                        <input type="radio" name="BillingEventOptions" id="DoNotUse" onclick="BillingEventSelect('DoNotUse')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">Blank {!Invoice_Type_Label}</span>
                                                    </label>
                                                    <label class="slds-radio slds-m-top_x-small">
                                                        <apex:outputPanel rendered="{!isBillingEventHasItems}">
                                                            <input type="radio" name="BillingEventOptions" id="UseBillingEventItems" onclick="BillingEventSelect('UseBillingEventItems')" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(isBillingEventHasItems,'Pre-Populate '+Invoice_Type_Label+' with Billing Event Items','(there are no Billing Event Items on this Billing Event)')}</span>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!NOT(isBillingEventHasItems)}">
                                                            <input type="radio" name="BillingEventOptions" id="UseBillingEventItems" onclick="BillingEventSelect('UseBillingEventItems')" disabled="disabled" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(isBillingEventHasItems,'Pre-Populate '+Invoice_Type_Label+' with Billing Event Items','(there are no Billing Event Items on this Billing Event)')}</span>
                                                        </apex:outputPanel>
                                                    </label>
                                                </div>
                                            </fieldset>
                                        </apex:outputPanel>
                                       
                                        <apex:inputHidden id="useBillingEventItems" value="{!useBillingEventItems}" />
                                        <script>
                                        document.getElementById('{!JSENCODE(useBillingEventItems)}').checked = true;
                                        </script>
                                    </apex:outputPanel>

                                <!-- Billing Event Items  End here -->

                                    <apex:outputPanel layout="block" styleClass="slds-m-bottom_large" rendered="{!AND(OR(AND(NOT(ISBLANK(parentid)), NOT(ISBLANK(child_relationship_name))), POforBusinessOrg), !POforBusinessOrg)}">
                                        <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Using {!child_object}s</h3>
                                        <script>
                                        function ChildSelect(inputvalue) {
                                            document.getElementById('{!JSENCODE($Component.theForm.ChildSelectOpt)}').value = inputvalue;
                                        }
                                        </script>
                                        
                                        <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" name="ChildOptions" id="DoNotUse" onclick="ChildSelect('DoNotUse')" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Blank {!Invoice_Type_Label}</span>
                                                </label>
                                                <label class="slds-radio slds-m-top_x-small">
                                                    <apex:outputPanel rendered="{!SobjectHaveProducts}">
                                                        <input type="radio" name="ChildOptions" id="UseProducts" onclick="ChildSelect('UseProducts')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">{!IF(SobjectHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with '+child_object+'s','(There are no '+child_object+'s on this ' +parentobjlabel+')')}</span>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(SobjectHaveProducts)}">
                                                        <input type="radio" name="ChildOptions" id="UseProducts" onclick="ChildSelect('UseProducts')" disabled="disabled" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">{!IF(SobjectHaveProducts,'Pre-Populate '+Invoice_Type_Label+' with '+child_object+'s','(There are no '+child_object+'s on this ' +parentobjlabel+')')}</span>
                                                    </apex:outputPanel>
                                                </label>
                                            </div>
                                        </fieldset>
                                        <apex:inputHidden id="ChildSelectOpt" value="{!UseSobjectProducts}" />
                                        <script>
                                        document.getElementById('{!JSENCODE(UseSobjectProducts)}').checked = true;
                                        </script>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel layout="block" id="theBlock" styleClass="slds-m-bottom_large" rendered="{!$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.accessible}">

                                        <apex:actionFunction name="reRenderPathPanel" status="assign-action-status" reRender="pathPanel" oncomplete="reRenderCheckSVG('#choosenStage1');reRenderCheckSVG('#choosenSupplier');"/>
                                        
                                        <h3 class="slds-section-title_divider" style="background: #f7f9fb;">Select the Xero Contact for this {!Invoice_Type_Label}</h3>
                                        <fieldset class="slds-form-element slds-m-top_small slds-m-left_medium">
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" name="xeroAccount" id="createNewXeroAccount" onchange="pushSelectedXeroAccount('createNewXeroAccount');" value="createNewXeroAccount" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Create a new Xero Contact</span>
                                                    <div style="padding-left: 31px;padding-top: 0.75rem;" class="slds-text-body_small">You can have multiple Xero Contacts associated with a single Salesforce Account. This might happen if you have different departments, branches, or offices of the same company.</div>
                                                </label>
                                                <apex:repeat value="{!selectedAccount.Xero_Contacts__r}" var="xA">
                                                    <label class="slds-radio slds-m-top_medium">
                                                        <input type="radio" name="xeroAccount" id="{!xA.Bread_Winner__Reference_Id__c}" onchange="pushSelectedXeroAccount('{!JSENCODE(xA.Reference_Id__c)}'); " value="{!xA.Bread_Winner__Reference_Id__c}" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">Use Existing Xero Contact: <b>{!xA.Bread_Winner__CompanyName__c}</b></span>
                                                        <span>
                                                            <apex:commandLink action="{!editXeroContact}" value="Edit Xero Contact before Creating the {!Invoice_type_Label}" styleClass="slds-text-body_small" style="text-decoration: underline;" id="editXeroContact">
                                                                <apex:param name="contIdParam" value="{!xA.id}" assignTo="{!xeroContactEditId}"/>
                                                            </apex:commandLink>
                                                        </span>
                                                        <apex:outputPanel layout="block" styleClass="slds-grid  slds-page-header__detail-row">
                                                            
                                                            <div class="slds-page-header__detail-block">
                                                                <apex:outputPanel layout="block"  rendered="{!OR(AND(NOT(ISBLANK(xA.Bread_Winner__CompanyName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__StreetAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__StreetAddress__c.accessible),AND(OR(NOT(ISBLANK(xA.Bread_Winner__Region__c)),NOT(ISBLANK(xA.Bread_Winner__PostalCode__c))),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__City__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Region__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__PostalCode__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__Country__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Country__c.accessible))}">
                                                                    <p title="Company Information" class="slds-text-heading_label-normal slds-m-bottom_xx-small" style="font-weight:bold">Company Information</p>
                                                                    <div class="slds-text-body_regular " style="display: block;text-overflow: ellipsis;overflow: hidden;">
                                                                        <apex:outputPanel id="compnyName" title="{!xA.Bread_Winner__CompanyName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__CompanyName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.accessible)}">
                                                                            {!xA.Bread_Winner__CompanyName__c}
                                                                            <br/>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__StreetAddress__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__StreetAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__StreetAddress__c.accessible)}">
                                                                            {!xA.Bread_Winner__StreetAddress__c}
                                                                            <br/>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__City__c} {!xA.Bread_Winner__Region__c} {!xA.Bread_Winner__PostalCode__c}" rendered="{!AND(OR(NOT(ISBLANK(xA.Bread_Winner__Region__c)),NOT(ISBLANK(xA.Bread_Winner__PostalCode__c))),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__City__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Region__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__PostalCode__c.accessible)}">
                                                                            {!xA.City__c},&nbsp;{!xA.Region__c}&nbsp;{!xA.PostalCode__c}
                                                                            <br/>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__Country__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__Country__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Country__c.accessible)}">
                                                                            {!xA.Bread_Winner__Country__c}
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-page-header__detail-block">
                                                                <apex:outputPanel layout="block" rendered="{!OR(AND(NOT(ISBLANK(xA.Bread_Winner__AttentionTo__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__AttentionTo__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__EmailAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__EmailAddress__c.accessible), AND(NOT(ISBLANK(xA.Bread_Winner__FirstName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__FirstName__c.accessible), AND(NOT(ISBLANK(xA.Bread_Winner__LastName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__LastName__c.accessible))}">
                                                                    <p class="slds-text-heading_label-normal slds-m-bottom_xx-small" style="font-weight:bold">Contact Info</p>
                                                                    <div class="slds-text-body_regular " style="display: block;text-overflow: ellipsis;overflow-wrap: break-word;">
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__AttentionTo__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__AttentionTo__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__AttentionTo__c.accessible)}" >
                                                                            {!xA.Bread_Winner__AttentionTo__c}
                                                                            <br/>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__FirstName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__FirstName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__FirstName__c.accessible)}">
                                                                            {!xA.Bread_Winner__FirstName__c}
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__LastName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__LastName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__LastName__c.accessible)}">
                                                                            {!xA.Bread_Winner__LastName__c}
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel title="{!xA.Bread_Winner__EmailAddress__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__EmailAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__EmailAddress__c.accessible)}">
                                                                            {!xA.Bread_Winner__EmailAddress__c}
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-page-header__detail-block">
                                                                <apex:outputPanel layout="block" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c)),isMultiOrgEnabled)}">
                                                                    <p class="slds-text-heading_label-normal  slds-m-bottom_xx-small" style="font-weight:bold">Xero Org</p>
                                                                    <div class="slds-text-body_regular " style="display: block;text-overflow: ellipsis;overflow: hidden;">
                                                                        <apex:outputPanel title="{!IF(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name), xA.Bread_Winner__Xero_Org_Name__c, appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name)}" rendered="{!$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Xero_Org_Name__c.accessible}">
                                                                            {!IF(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name), xA.Bread_Winner__Xero_Org_Name__c, appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name)}
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!NOT(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Logo_URL))}">
                                                                            <br/>
                                                                            <apex:image style="height: 40px" url="{!appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Logo_URL}" />
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-page-header__detail-block">
                                                                <apex:outputPanel layout="block" styleClass="slds-page-header__detail-block" rendered="{!AND(isProfessionalOrHigher, OR(xeroOrgCurrencies.size>2, haveMultiCurrencyOrg))}">
                                                                    <apex:variable var="list" value="{!''}{!CurrencyValues}" />
                                                                    <p class="slds-text-heading_label-normal  slds-m-bottom_xx-small" style="font-weight:bold">Currency</p>
                                                                    <div class="slds-text-body_regular">
                                                                        <apex:outputPanel title="{!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}" rendered="{!AND($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__DefaultCurrency__c.accessible, ISBLANK(Opportunity_record_Currency))}">
                                                                            {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!NOT(ISBLANK(Opportunity_record_Currency))}">
                                                                            <apex:outputPanel style="color:red;" rendered="{! Opportunity_record_Currency != if(NOT(ISBLANK(xA.DefaultCurrency__c)),xA.DefaultCurrency__c,if(ISBLANK(xA.Xero_Org_ID__c), '', if(contains(list, xA.Xero_Org_ID__c),CurrencyValues[xA.Xero_Org_ID__c],'')))}">
                                                                                {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel style="color:green;" rendered="{! Opportunity_record_Currency == if(NOT(ISBLANK(xA.DefaultCurrency__c)),xA.DefaultCurrency__c,if(ISBLANK(xA.Xero_Org_ID__c), '', if(contains(list, xA.Xero_Org_ID__c),CurrencyValues[xA.Xero_Org_ID__c],'')))}">
                                                                                {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </label>
                                                </apex:repeat>
                                            </div>
                                        </fieldset>

                                        <apex:outputPanel layout="block" rendered="{!OR(NOT(OR(BillorPOfromMPB,InvoicefromURL)),AND(BillorPOfromMPB,LEN(parentid)<1))}" styleClass="slds-m-top_medium" style="text-align:center;font-size: 10px;">
                                            <apex:commandLink value="Search for another Xero Contact" action="{!searchForBAC}"  reRender="mainPanel" status="assign-action-status" oncomplete="reRenderAccountSVG();message();" style="color: #f3f3f3;"/>
                                        </apex:outputPanel>

                                        <script>
                                        document.getElementById('{!JSENCODE(selectedXeroAccount)}').checked = true;
                                        </script>
                                        <script>
                                        function pushSelectedXeroAccount(refId) {
                                            document.getElementById('{!JSENCODE($Component.theForm.selectedXeroAccount)}').value = refId;
                                            reRenderPathPanel();
                                        }
                                        </script>
                                        <div class="slds-text-align_center slds-m-top_medium">
                                            <apex:commandButton value="Next" action="{!next}" status="assign-action-status" styleClass="slds-button slds-button_brand slds-m-right_small" disabled="{!Not($ObjectType.Bread_Winner__Invoice__c.Createable)}" id="nextButton"/>
                                            <apex:commandButton value="Cancel" action="{!cancel}" styleClass="slds-button slds-button_neutral" id="cancelButton"/>
                                        </div>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        <!--- Select Invoice Type, Products, Suppleirs and BAC Section End -->

                        <apex:inputHidden id="selectedXeroAccount" value="{!selectedXeroAccount}" />

                        <!--- Create or Edit BAC Section Start -->
                        <apex:outputPanel id="accountPanel" layout="block" rendered="{!showAccountPanel}">
                            <div class="slds-page-header" role="banner" style="background: #f7f9fb;">
                                <div class="slds-media">
                                    <div class="slds-media__figure" id="accountIcon">
                                        <svg aria-hidden="true" class="slds-icon slds-icon-standard-user">
                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#moneybag')}"></use>
                                        </svg>
                                    </div>
                                    <div class="slds-media__body">
                                        <p class="slds-page-header__title slds-truncate" title="{!IF(isEditAccount,'Edit Breadwinner Xero Contact','New Breadwinner Xero Contact')}"> 
                                            <apex:outputText rendered="{!NOT(isEditAccount)}">New Breadwinner Xero Contact</apex:outputText>
                                            <apex:outputText rendered="{!isEditAccount}">Edit Breadwinner Xero Contact</apex:outputText>
                                        </p>
                                        <p class="slds-text-body_small">Breadwinner â€¢ Xero </p>
                                    </div>
                                </div>
                            </div>
                            <apex:outputPanel layout="block" id="bacPathPanel">
                                <div class="slds-path slds-m-top_x-small slds-m-bottom_x-small">
                                    <div class="slds-grid slds-path__track">
                                        <div class="slds-grid slds-path__scroller-container">
                                            <div class="slds-path__scroller" role="application">
                                                <div class="slds-path__scroller_inner">
                                                    <ul class="slds-path__nav" role="listbox" aria-orientation="horizontal">
                                                        <li class="slds-path__item slds-is-complete" role="presentation">
                                                            <span class="slds-path__link">
                                                                <span class="slds-path__stage" id="choosenStage2">
                                                                    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                    </svg>
                                                                    <span class="slds-assistive-text">Chosen {!IF(NOT(ISBLANK(ParentobjectName)),ParentobjectName,IF(InvoiceFromOrder, 'Order',IF(NOT(ISBLANK(sfInvoice.Opportunity__c)),'Opportunity',IF(InvoiceFromBillingEvent, 'Billing Event', 'Account'))))}</span>
                                                                </span>
                                                                <span class="slds-path__title">Chosen {!IF(NOT(ISBLANK(ParentobjectName)),ParentobjectName,IF(InvoiceFromOrder, 'Order',IF(NOT(ISBLANK(sfInvoice.Opportunity__c)),'Opportunity',IF(InvoiceFromBillingEvent, 'Billing Event', 'Account'))))}</span>
                                                            </span>
                                                        </li>
                                                        <li class="slds-path__item slds-is-complete" role="presentation" style="display:{!IF(AND(OR(BillorPOfromMPB,InvoicefromURL),Suppliers.size>1),'','none')}">
                                                            <span class="slds-path__link">
                                                                <span class="slds-path__stage" id="choosenSupplier">
                                                                    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                    </svg>
                                                                    <span class="slds-assistive-text">Selected Supplier</span>
                                                                </span>
                                                                <span class="slds-path__title">Selected Supplier</span>
                                                            </span>
                                                        </li>
                                                        <li class="slds-path__item slds-is-complete" role="presentation">
                                                            <span class="slds-path__link">
                                                                <span class="slds-path__stage" id="selectBACStage">
                                                                    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                    </svg>
                                                                    <span class="slds-assistive-text">Selected Xero Contact</span>
                                                                </span>
                                                                <span class="slds-path__title">Selected Xero Contact</span>
                                                            </span>
                                                        </li>
                                                        <li class="slds-path__item slds-is-active slds-is-current" role="presentation">
                                                            <span class="slds-path__link">
                                                                <span class="slds-path__stage">
                                                                    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                    </svg>
                                                                    <span class="slds-assistive-text">{!IF(isEditAccount,'Edit','Create a')}&nbsp;Xero Contact</span>
                                                                </span>
                                                                <span class="slds-path__title">{!IF(isEditAccount,'Edit','Create a')}&nbsp;Xero Contact</span>
                                                            </span>
                                                        </li>
                                                        <li class="slds-path__item slds-is-incomplete" role="presentation">
                                                            <span class="slds-path__link">
                                                                <span class="slds-path__stage">
                                                                    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                                                                        <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#check')}" />
                                                                    </svg>
                                                                    <span class="slds-assistive-text">Create a Xero {!Invoice_Type_Label}</span>
                                                                </span>
                                                                <span class="slds-path__title">Create a Xero {!Invoice_Type_Label}</span>
                                                            </span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>
                            <apex:pageMessage severity="info" rendered="{!isReadOnlyMode}" summary="You are using Breadwinner in Xero Read Only Mode. While Breadwinner reads data from Xero, no changes will be made to Xero. Xero is in Read-Only mode and will not be altered in any way."></apex:pageMessage>
                            <apex:outputPanel layout="block" rendered="{!bacExists}" style="border-radius:4px;" styleClass="warningM3 slds-m-top_small slds-m-bottom_small" >
                                You are trying to create a Xero Contact, but another Xero Contact with that name already exists. The existing Xero Contact is called "{!sfAccountChild.Bread_Winner__CompanyName__c}" and is already associated with a different Salesforce Account&nbsp;"<apex:outputField value="{!existingBAC.Bread_Winner__Salesforce_Account__c}"/>".
                                <br/> <br/>
                                You have several options:
                                <br/>
                                <ul>
                                    <li>Create a new Xero Contact but give it a different name.</li>
                                    <li>Merge the Salesforce Account&nbsp;<apex:outputField value="{!existingBAC.Bread_Winner__Salesforce_Account__c}"/> with this one. Start the&nbsp;
                                        <apex:outputLink value="/merge/accmergewizard.jsp?goNext=+Next+&cid={!sfAccountChild.Bread_Winner__Salesforce_Account__c}&cid={!existingBAC.Bread_Winner__Salesforce_Account__c}" target="_top" id="sfAccountMergeWizard">Salesforce Account merge wizard</apex:outputLink>.
                                    </li>
                                    <li>Associate the existing Xero Contact "{!sfAccountChild.Bread_Winner__CompanyName__c}" with this Salesforce Account instead of with&nbsp;<apex:outputField value="{!existingBAC.Bread_Winner__Salesforce_Account__c}"/>. <apex:commandlink action="{!reparentExistingBAC}" id="reparentExistingBAC">Associate with this Account</apex:commandlink>.</li>
                                </ul>
                                To understand more about how Breadwinner associates Xero contacts with Salesforce Accounts, this&nbsp;<a href="https://help-xero.breadwinner.com/support/solutions/articles/44001664285" target="_blank">knowledge base article</a> might help. Warning: it's long and technical!
                            </apex:outputPanel>
                            <apex:outputPanel layout="block" rendered="{!bacExistswithoutAccount}" style="border-radius:4px;" styleClass="warningM3 slds-m-top_small slds-m-bottom_small" >
                                You are trying to create a Xero Contact, but another Xero Contact with that name already exists. The existing Xero Contact is called "{!sfAccountChild.Bread_Winner__CompanyName__c}" and is already imported to Salesforce but not associated with any Salesforce Account.
                                <br/> <br/>
                                You have several options:
                                <br/>
                                <ul>
                                    <li>Create a new Xero Contact but give it a different name.</li>
                                    <li>Associate the existing Xero Contact "{!sfAccountChild.Bread_Winner__CompanyName__c}" with this Salesforce Account by clicking this <apex:commandlink action="{!reparentExistingBAC}" id="associateExistingBAC">Associate with this Account</apex:commandlink>.</li>
                                </ul>
                                To understand more about how Breadwinner associates Xero contacts with Salesforce Accounts, this&nbsp;<a href="https://help-xero.breadwinner.com/support/solutions/articles/44001664285" target="_blank">knowledge base article</a> might help. Warning: it's long and technical!
                            </apex:outputPanel>
                            <apex:outputPanel layout="block"  rendered="{!bacExistsMsg2}" style="border-radius:4px;" styleClass="warningM3 slds-m-top_small slds-m-bottom_small" >
                                A Xero Contact with the same name already exists and is related to the current Salesforce Account&nbsp; <apex:outputField value="{!existingBAC.Bread_Winner__Salesforce_Account__c}" style="color:black;"/>. You can either create a new Xero Contact by giving it a different name or choose the existing Xero Contact in the previous page.
                            </apex:outputPanel>
                            <apex:pageMessage escape="false" rendered="{!isOAuthIssue}" detail="{!oAuthExceptionWarningMessage}" summary="There was a problem with the connection to Xero." severity="WARNING" strength="3" />
                            <apex:pagemessage severity="ERROR" strength="2" summary="Error while creating Xero Contact" escape="false" rendered="{!isConnectionIsuue}">
                                We were unable to connect to Xero. This could be a temporary issue on the part of Xero's servers, so please try again in a minute. You can also see&nbsp;
                                <a href="https://status.developer.xero.com/" class="slds-text-body_small" target="_blank">Xero's API Status</a>. 
                                If the API is up, and you still get this error message after waiting a few minutes, please contact&nbsp; 
                                <a href="https://help-xero.breadwinner.com/support/tickets/new" class="slds-text-body_small" target="_blank">Breadwinner Support
                                </a>.
                            </apex:pagemessage>
                            <apex:pageMessage rendered="{!OR(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.createable), NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.createable), Not($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Reference_Id__c.Updateable), AND(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.Updateable), isEditAccount))}" detail="{!PermissionSetErrorMessage}" summary="Insufficient Access" severity="WARNING" strength="3" escape="false"/>
                            <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-p-around_small">
                                <div class="slds-col slds-grid slds-wrap slds-size_1-of-1 slds-medium-size_2-of-3 slds-large-size_4-of-12">
                                    <apex:outputPanel layout="block" styleClass="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_x-small" rendered="{!AND(isMultiOrgEnabled,NOT(isEditAccount))}">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Xero Org</span>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectList id="selectOptionId" label="Xero Org" size="1" value="{!xeroOrgId}" required="true"  styleClass="slds-select">
                                                        <apex:actionSupport event="onchange" action="{!xeroOrgCurrencies}" reRender="conDefaultCurrency1,conDefaultTaxRate1" />
                                                        <apex:selectOptions value="{!xeroOrgSelectOptionList}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="block" id="conDefaultCurrency1" styleClass="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-vertical_x-small slds-grid slds-grid_vertical" rendered="{!OR(AND(xeroOrgCurrencies.size>2, OR(isProfessionalOrHigher, isOnTrial)), isMultiOrgEnabled) }">
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Default Currency for Xero Contact
                                            <apex:outputPanel styleClass="slds-form-element__icon" >
                                                <a href="javascript:void(0);">
                                                    <img style="margin-left: 5px;margin-bottom: 4px;height:15px;width:15px;" src="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/Images/InfoLightning.png')}" onmouseover="identifyfield(this,'Selecting the default Currency for New Xero Contacts is only available on Breadwinner Professional Edition and above. You can use this feature during your free trial, but to keep using it after your trial you must subscribe at the Professional or more.', '220','26')" onmouseout="mouseoutclose();" />
                                                    <span class="slds-assistive-text">Help</span>
                                                </a>
                                            </apex:outputPanel>
                                            </span>
                                            <div class="slds-form-element__control">
                                                <apex:outputPanel rendered="{!OR(xeroOrgCurrencies.size>2, isEditAccount)}">
                                                    <div class="slds-select_container">
                                                        <apex:selectList label="Default Currency" size="1" value="{!conDefaultCurrency}" styleClass="slds-select" rendered="{!OR(xeroOrgCurrencies.size>2, isEditAccount)}" id="xeroOrgCurrencies">
                                                            <apex:selectOptions value="{!xeroOrgCurrencies}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputText value="{!conDefaultCurrency}" rendered="{!AND(NOT(haveMultiCurrency), isMultiOrgEnabled, NOT(isEditAccount))}"></apex:outputText>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                </div>
                                <apex:outputPanel layout="block" id="CustomerMappingSection">
                                    <div class="slds-section slds-is-open ">
                                        <h3 class="slds-section__title slds-theme_shade">
                                            <span class="slds-truncate slds-p-horizontal_small" title="Mapping Customer Details from Salesforce">Mapping Customer Details from Salesforce</span>
                                        </h3>
                                        <div aria-hidden="false">
                                            <apex:outputPanel layout="block" styleClass="slds-size_1-of-1 slds-grid slds-grid_vertical">
                                                <apex:outputPanel layout="block" styleClass="slds-p-top_medium slds-p-bottom_x-small slds-grid slds-wrap">
                                                    <div class="slds-col_padded slds-size_1-of-1 slds-large-size_2-of-12"></div>
                                                    <div class="slds-col_padded slds-large-size_4-of-12"> 
                                                        <div class="slds-text-heading_medium slds-text-align_center">Details from Salesforce Contact</div>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle"></div>
                                                    <div class="slds-col_padded slds-large-size_4-of-12"> 
                                                        <div class="slds-text-heading_medium slds-text-align_center"><apex:outputText value="{!IF(isEditAccount,'Details from Xero Contact','New Xero Contact')}" /></div>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel id="primaryContactSection">
                                                    <h3 class="slds-section__title slds-p-left_small">Primary Contact Details:</h3>
                                                        <script>
                                                            function changeTheContact() {
                                                                j$('input[id$=firstNameInput]').val('{!mapOfContactIdcontactWrapperList[selectedContactId].FirstName}');
                                                                j$('input[id$=lastNameInput]').val('{!mapOfContactIdcontactWrapperList[selectedContactId].LastName}');
                                                                j$('input[id$=emailInput]').val('{!mapOfContactIdcontactWrapperList[selectedContactId].Email}');
                                                            }
                                                        </script>
                                                    <apex:outputPanel layout="block" styleClass="slds-grid slds-wrap slds-p-vertical_x-small" id="salesforceContacts">
                                                        <div class="slds-col_padded slds-large-size_2-of-12 slds-size_1-of-1">
                                                            <apex:outputText styleClass="slds-text-heading_small" value="Salesforce Contact"/>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:outputText rendered="{!sfContacts.size<2}" style="color:red" value="No Salesforce Contacts exist for this Salesforce Account"/>
                                                            <apex:outputPanel layout="block" rendered="{!sfContacts.size>1}">
                                                                <div class="slds-form-element">
                                                                    <div class="slds-form-element__control">
                                                                        <div class="slds-select_container">
                                                                            <apex:selectList styleClass="slds-select" id="selectedContact" value="{!selectedContactId}" size="1">
                                                                                <apex:selectOptions value="{!sfContacts}"></apex:selectOptions>
                                                                                <apex:actionSupport event="onchange" reRender="primaryContactSection" status="assign-action-status" oncomplete="{!IF(isEditAccount,'','changeTheContact();')}"/>
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-grid slds-wrap slds-p-vertical_x-small" id="FirstNameSection">
                                                        <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                            <apex:outputText styleClass="slds-text-heading_small" value="First Name"/>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputText id="sfFirstName" value="{!mapOfContactIdcontactWrapperList[selectedContactId].FirstName}" styleClass="slds-input slds-is-disabled" html-autofocus="false" disabled="true"/>
                                                        </div>
                                                        <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                            <div class="arrowCell slds-text-align_center">
                                                                <apex:actionStatus id="status1">
                                                                    <apex:facet name="start">
                                                                        <div class="slds-spinner_brand slds-spinner slds-spinner_x-small arrowSpinner" role="status">
                                                                            <div class="slds-spinner__dot-a"></div>
                                                                            <div class="slds-spinner__dot-b"></div>
                                                                        </div>      
                                                                    </apex:facet>
                                                                    <apex:facet name="stop">
                                                                        <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('firstNameInput','{!mapOfContactIdcontactWrapperList[selectedContactId].FirstName}');" status="status1" reRender="FirstNameSection" rendered="{!IF(AND(lower(sfAccountChild.Bread_Winner__FirstName__c)!=lower(mapOfContactIdcontactWrapperList[selectedContactId].FirstName),NOT(ISBLANK(mapOfContactIdcontactWrapperList[selectedContactId].FirstName)),isEditAccount),'TRUE','FALSE')}">
                                                                            <span title="Copy this First Name in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                        </apex:commandlink>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputField id="firstNameInput" label="First Name" value="{!sfAccountChild.Bread_Winner__FirstName__c}" styleClass="slds-input" html-autofocus="false"/>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-grid slds-wrap slds-p-vertical_x-small" id="LastNameSection">
                                                        <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                            <apex:outputText styleClass="slds-text-heading_small" value="Last Name"/>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputText id="sfLastName" value="{!mapOfContactIdcontactWrapperList[selectedContactId].LastName}" styleClass="slds-input slds-is-disabled" html-autofocus="false" disabled="true"/>
                                                        </div>
                                                        <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                            <div class="arrowCell slds-text-align_center">
                                                                <apex:actionStatus id="status2">
                                                                    <apex:facet name="start">
                                                                        <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                            <div class="slds-spinner__dot-a"></div>
                                                                            <div class="slds-spinner__dot-b"></div>
                                                                        </div>      
                                                                    </apex:facet>
                                                                    <apex:facet name="stop">
                                                                        <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('lastNameInput','{!mapOfContactIdcontactWrapperList[selectedContactId].Lastname}');" status="status2" reRender="LastNameSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__LastName__c)!=lower(mapOfContactIdcontactWrapperList[selectedContactId].Lastname),NOT(ISBLANK(mapOfContactIdcontactWrapperList[selectedContactId].Lastname))),'TRUE','FALSE')}">
                                                                            <span title="Copy this Last Name in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                        </apex:commandlink>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputField id="lastNameInput" label="Last Name" value="{!sfAccountChild.Bread_Winner__LastName__c}" styleClass="slds-input" html-autofocus="false"/>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="slds-grid slds-wrap slds-p-vertical_x-small" id="EmailSection">
                                                        <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                            <apex:outputText styleClass="slds-text-heading_small" value="Email"/>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputText id="contactEmail" value="{!mapOfContactIdcontactWrapperList[selectedContactId].Email}" styleClass="slds-input slds-is-disabled" html-autofocus="false" disabled="true" />
                                                        </div>
                                                        <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                            <div class="arrowCell slds-text-align_center">
                                                                <apex:actionStatus id="status3">
                                                                    <apex:facet name="start">
                                                                        <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                            <div class="slds-spinner__dot-a"></div>
                                                                            <div class="slds-spinner__dot-b"></div>
                                                                        </div>      
                                                                    </apex:facet>
                                                                    <apex:facet name="stop">
                                                                        <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('emailInput','{!mapOfContactIdcontactWrapperList[selectedContactId].Email}');" status="status3" reRender="EmailSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__EmailAddress__c)!=lower(mapOfContactIdcontactWrapperList[selectedContactId].Email),NOT(ISBLANK(mapOfContactIdcontactWrapperList[selectedContactId].Email))),'TRUE','FALSE')}">
                                                                            <span title="Copy this Email in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                        </apex:commandlink>
                                                                    </apex:facet>
                                                                </apex:actionStatus>
                                                            </div>
                                                        </div>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:inputField id="emailInput" label="Email" value="{!sfAccountChild.Bread_Winner__EmailAddress__c}" styleClass="slds-input" html-autofocus="false"/>
                                                        </div>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                                <!-- Additional Contacs section started -->
                                                <div style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_1_First_Name__c!='',sfAccountChild.Contact_1_Last_Name__c!='',sfAccountChild.Contact_1_Email__c!='')),'None','')};" class="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AddConLink1">
                                                    <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:commandLink status="assign-action-status" onclick="ShowHideSection('AddConLink1');" oncomplete="ShowHideSection('ContactPerson1Section');">Add another Contact</apex:commandLink>
                                                    </div>
                                                </div>
                                                <div id="ContactPerson1Section" style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_1_First_Name__c!='',sfAccountChild.Contact_1_Last_Name__c!='',sfAccountChild.Contact_1_Email__c!='')),'','None')};">
                                                    <apex:outputPanel layout="block" id="ContactSection1" rendered="{!IF(AND(isEditAccount,OR(sfAccountChild.Bread_Winner__Contact_1_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_1_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_1_Email__c!='')),(OR(sfAccountChild.Bread_Winner__Contact_1_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_1_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_1_Email__c!='')),true)}">
                                                        <hr style="margin-top: 5px; margin-bottom: 10px;"/>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="FirstName1">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">First Name</label>
                                                                <apex:inputField id="fname1" label="First Name" value="{!sfAccountChild.Bread_Winner__Contact_1_First_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="LastName1">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Last Name</label>
                                                                <apex:inputField id="lname1" label="Last Name" value="{!sfAccountChild.Bread_Winner__Contact_1_Last_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="EmailAddress1">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Email Address</label>
                                                                <apex:inputField id="email1" label="Email Address" value="{!sfAccountChild.Bread_Winner__Contact_1_Email__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="IncludeInEmails1">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Include In Emails</label>
                                                                <apex:inputCheckbox id="includeEmail1" label="Include In Emails" value="{!sfAccountChild.Bread_Winner__Contact_1_Include_in_Emails__c}" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <div style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_2_First_Name__c!='',sfAccountChild.Contact_2_Last_Name__c!='',sfAccountChild.Contact_2_Email__c!='')),'None','')};" class="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AddConLink2">
                                                        <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:commandLink status="assign-action-status" onclick="ShowHideSection('AddConLink2');" oncomplete="ShowHideSection('ContactPerson2Section');">Add another Contact</apex:commandLink>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="ContactPerson2Section" style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_2_First_Name__c!='',sfAccountChild.Contact_2_Last_Name__c!='',sfAccountChild.Contact_2_Email__c!='')),'','None')};">
                                                    <apex:outputPanel layout="block" id="ContactSection2" rendered="{!IF(AND(isEditAccount,OR(sfAccountChild.Bread_Winner__Contact_2_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_2_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_2_Email__c!='')),(OR(sfAccountChild.Bread_Winner__Contact_2_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_2_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_2_Email__c!='')),true)}">
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="FirstName2">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <hr style="margin-top: 5px; margin-bottom: 10px;"/>
                                                                <label class="slds-form-element__label slds-p-top_none">First Name</label>
                                                                <apex:inputField id="fname2" label="First Name" value="{!sfAccountChild.Bread_Winner__Contact_2_First_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="LastName2">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Last Name</label>
                                                                <apex:inputField id="lname2" label="Last Name" value="{!sfAccountChild.Bread_Winner__Contact_2_Last_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="EmailAddress2">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Email Address</label>
                                                                <apex:inputField id="email2" label="Email Address" value="{!sfAccountChild.Bread_Winner__Contact_2_Email__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="IncludeInEmails2">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Include In Emails</label>
                                                                <apex:inputCheckbox id="includeEmail2" label="Include In Emails" value="{!sfAccountChild.Bread_Winner__Contact_2_Include_in_Emails__c}" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <div style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_3_First_Name__c!='',sfAccountChild.Contact_3_Last_Name__c!='',sfAccountChild.Contact_3_Email__c!='')),'None','')};" class="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AddConLink3">
                                                        <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:commandLink status="assign-action-status" onclick="ShowHideSection('AddConLink3');" oncomplete="ShowHideSection('ContactPerson3Section');">Add another Contact</apex:commandLink>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="ContactPerson3Section" style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_3_First_Name__c!='',sfAccountChild.Contact_3_Last_Name__c!='',sfAccountChild.Contact_3_Email__c!='')),'','None')};">
                                                    <apex:outputPanel layout="block" id="ContactSection3" rendered="{!IF(AND(isEditAccount,OR(sfAccountChild.Bread_Winner__Contact_3_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_3_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_3_Email__c!='')),(OR(sfAccountChild.Bread_Winner__Contact_3_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_3_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_3_Email__c!='')),true)}">
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="FirstName3">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <hr style="margin-top: 5px; margin-bottom: 10px;"/>
                                                                <label class="slds-form-element__label slds-p-top_none">First Name</label>
                                                                <apex:inputField id="fname3" label="First Name" value="{!sfAccountChild.Bread_Winner__Contact_3_First_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="LastName3">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Last Name</label>
                                                                <apex:inputField id="lname3" label="Last Name" value="{!sfAccountChild.Bread_Winner__Contact_3_Last_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="EmailAddress3">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Email Address</label>
                                                                <apex:inputField id="email3" label="Email Address" value="{!sfAccountChild.Bread_Winner__Contact_3_Email__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="IncludeInEmails3">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Include In Emails</label>
                                                                <apex:inputCheckbox id="includeEmail3" label="Include In Emails" value="{!sfAccountChild.Bread_Winner__Contact_3_Include_in_Emails__c}" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <div style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_4_First_Name__c!='',sfAccountChild.Contact_4_Last_Name__c!='',sfAccountChild.Contact_4_Email__c!='')),'None','')};" class="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AddConLink4">
                                                        <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:commandLink status="assign-action-status" onclick="ShowHideSection('AddConLink4');" oncomplete="ShowHideSection('ContactPerson4Section');">Add another Contact</apex:commandLink>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="ContactPerson4Section" style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_4_First_Name__c!='',sfAccountChild.Contact_4_Last_Name__c!='',sfAccountChild.Contact_4_Email__c!='')),'','None')};">
                                                    <apex:outputPanel layout="block" id="ContactSection4" rendered="{!IF(AND(isEditAccount,OR(sfAccountChild.Bread_Winner__Contact_4_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_4_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_4_Email__c!='')),(OR(sfAccountChild.Bread_Winner__Contact_4_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_4_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_4_Email__c!='')),true)}">
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="FirstName4">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <hr style="margin-top: 5px; margin-bottom: 10px;"/>
                                                                <label class="slds-form-element__label slds-p-top_none">First Name</label>
                                                                <apex:inputField id="fname4" label="First Name" value="{!sfAccountChild.Bread_Winner__Contact_4_First_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="LastName4">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Last Name</label>
                                                                <apex:inputField id="lname4" label="Last Name" value="{!sfAccountChild.Bread_Winner__Contact_4_Last_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="EmailAddress4">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Email Address</label>
                                                                <apex:inputField id="email4" label="Email Address" value="{!sfAccountChild.Bread_Winner__Contact_4_Email__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="IncludeInEmails4">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Include In Emails</label>
                                                                <apex:inputCheckbox id="includeEmail4" label="Include In Emails" value="{!sfAccountChild.Bread_Winner__Contact_4_Include_in_Emails__c}" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                    <div style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_5_First_Name__c!='',sfAccountChild.Contact_5_Last_Name__c!='',sfAccountChild.Contact_5_Email__c!='')),'None','')};" class="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AddConLink5">
                                                        <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                        <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                            <apex:commandLink status="assign-action-status" onclick="ShowHideSection('AddConLink5');" oncomplete="ShowHideSection('ContactPerson5Section');">Add another Contact</apex:commandLink>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="ContactPerson5Section" style="display:{!if(AND(isEditAccount,OR(sfAccountChild.Contact_5_First_Name__c!='',sfAccountChild.Contact_5_Last_Name__c!='',sfAccountChild.Contact_5_Email__c!='')),'','None')};">
                                                    <apex:outputPanel layout="block" id="ContactSection5" rendered="{!IF(AND(isEditAccount,OR(sfAccountChild.Bread_Winner__Contact_5_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_5_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_5_Email__c!='')),(OR(sfAccountChild.Bread_Winner__Contact_5_First_Name__c!='',sfAccountChild.Bread_Winner__Contact_5_Last_Name__c!='',sfAccountChild.Bread_Winner__Contact_5_Email__c!='')),true)}">
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="FirstName5">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <hr style="margin-top: 5px; margin-bottom: 10px;"/>
                                                                <label class="slds-form-element__label slds-p-top_none">First Name</label>
                                                                <apex:inputField id="fname5" label="First Name" value="{!sfAccountChild.Bread_Winner__Contact_5_First_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="LastName5">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Last Name</label>
                                                                <apex:inputField id="lname5" label="Last Name" value="{!sfAccountChild.Bread_Winner__Contact_5_Last_Name__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="EmailAddress5">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Email Address</label>
                                                                <apex:inputField id="email5" label="Email Address" value="{!sfAccountChild.Bread_Winner__Contact_5_Email__c}" styleClass="slds-input" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="IncludeInEmails5">
                                                            <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                            <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                                <label class="slds-form-element__label slds-p-top_none">Include In Emails</label>
                                                                <apex:inputCheckbox id="includeEmail5" label="Include In Emails" value="{!sfAccountChild.Bread_Winner__Contact_5_Include_in_Emails__c}" html-autofocus="false"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                                <!-- Additional Contacs section ended -->
                                            </apex:outputPanel>
                                            <div class="slds-grid slds-grid_vertical">
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-top_medium">
                                                    <div class="slds-col_padded slds-size_1-of-1 slds-large-size_2-of-12"></div>
                                                    <div class="slds-col_padded slds-large-size_4-of-12"> 
                                                        <div class="slds-text-heading_medium slds-text-align_center">Details from Salesforce Account</div>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle"></div>
                                                    <apex:outputPanel styleClass="slds-col_padded slds-large-size_4-of-12" layout="block"> 
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="CompanyNameSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Company Name"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputText id="companyName" label="Company Name" value="{!selectedAccountName}" styleClass="slds-input slds-is-disabled" html-autofocus="false" disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status4">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('companyNameInput','{!selectedAccountName}');" status="status4" reRender="CompanyNameSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__CompanyName__c)!=lower(selectedAccountName),NOT(ISBLANK(selectedAccountName))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Company Name in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="companyNameInput" label="Company Name" value="{!sfAccountChild.Bread_Winner__CompanyName__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="StreetAddressSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Street Address"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputTextarea id="billingAddress" label="Street Address" value="{!selectedAccount.BillingStreet}" styleClass="slds-input slds-is-disabled" html-autofocus="false" disabled="true"/>
                                                    </div>                                            
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status5">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('billingAddressInput','');" status="status5" reRender="StreetAddressSection" rendered="{!IF(AND(isEditAccount,NOT(isStreetAddressSame),NOT(ISBLANK(selectedAccount.BillingStreet))),'TRUE','FALSE')}" oncomplete="reRenderStreetAddressValue();">
                                                                        <span title="Copy this Street Address in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputTextarea id="billingAddressInput" label="Street Address" value="{!sfAccountChild.Bread_Winner__StreetAddress__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:actionFunction name="reRenderStreetAddressValue" action="{!reRenderStreetAddress}" reRender="StreetAddressSection">
                                                    <apex:param name="bacStreetAddress" value="{!selectedAccount.BillingStreet}" assignTo="{!sfAccountChild.Bread_Winner__StreetAddress__c}" />
                                                </apex:actionFunction>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="BillingCitySection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Town / City"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-medium-size_2-of-5 slds-size_1-of-1">
                                                        <apex:inputField id="billingCity" label="Town / City" value="{!selectedAccount.BillingCity}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true" />
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status6">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('billingCityInput','{!selectedAccount.BillingCity}');" status="status6" reRender="BillingCitySection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__City__c)!=lower(selectedAccount.BillingCity),NOT(ISBLANK(selectedAccount.BillingCity))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Town / City in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-medium-size_2-of-5 slds-size_1-of-1">
                                                        <apex:inputField id="billingCityInput" label="Town / City" value="{!sfAccountChild.Bread_Winner__City__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="BillingStateSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="State / Region"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-medium-size_2-of-5 slds-size_1-of-1">
                                                        <apex:inputField id="billingState" label="State / Region" value="{!selectedAccount.BillingState}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status7">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('billingStateInput','{!selectedAccount.BillingState}');" status="status7" reRender="BillingStateSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__Region__c)!=lower(selectedAccount.BillingState),NOT(ISBLANK(selectedAccount.BillingState))),'TRUE','FALSE')}">
                                                                        <span title="Copy this State / Region in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-medium-size_2-of-5 slds-size_1-of-1">
                                                        <apex:inputField id="billingStateInput" label="State / Region" value="{!sfAccountChild.Bread_Winner__Region__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="BillingZipSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Postal / Zip Code"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="billingZip" label="Postal / Zip Code" value="{!selectedAccount.BillingPostalCode}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status8">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('billingZipInput','{!selectedAccount.BillingPostalCode}');" status="status8" reRender="BillingZipSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__PostalCode__c)!=lower(selectedAccount.BillingPostalCode),NOT(ISBLANK(selectedAccount.BillingPostalCode))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Postal / Zip Code in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="billingZipInput" label="Postal / Zip Code" value="{!sfAccountChild.Bread_Winner__PostalCode__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="BillingCountrySection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Country"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-medium-size_2-of-5 slds-size_1-of-1">
                                                        <apex:inputField id="billingCountry" label="Country" value="{!selectedAccount.BillingCountry}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status9">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('countryInput','{!selectedAccount.BillingCountry}');" status="status9" reRender="BillingCountrySection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__Country__c)!=lower(selectedAccount.BillingCountry),NOT(ISBLANK(selectedAccount.BillingCountry))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Country in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="countryInput" label="Country" value="{!sfAccountChild.Bread_Winner__Country__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="PhoneSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Phone"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="phone" label="Phone" value="{!selectedAccount.Phone}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status10">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('phoneInput','{!selectedAccount.Phone}');" status="status10" reRender="PhoneSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__Phone__c)!=lower(selectedAccount.Phone),NOT(ISBLANK(selectedAccount.Phone))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Phone in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="phoneInput" label="Phone" value="{!sfAccountChild.Bread_Winner__Phone__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_x-small" id="AccountNumberSection">
                                                    <div class="slds-col_padded slds-p-top_x-small slds-large-size_2-of-12 slds-size_1-of-1">
                                                        <apex:outputText styleClass="slds-text-heading_small" value="Account Number"/>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="accountNumber" label="Account Number" value="{!selectedAccount.AccountNumber}" styleClass="slds-input slds-is-disabled" html-autofocus="false" html-disabled="true"/>
                                                    </div>
                                                    <div class="slds-col_padded slds-large-size_1-of-12 slds-align-middle">
                                                        <div class="arrowCell slds-text-align_center">
                                                            <apex:actionStatus id="status11">
                                                                <apex:facet name="start">
                                                                    <div class="slds-spinner_brand slds-spinner slds-spinner_x-small  arrowSpinner" role="status">
                                                                        <div class="slds-spinner__dot-a"></div>
                                                                        <div class="slds-spinner__dot-b"></div>
                                                                    </div>      
                                                                </apex:facet>
                                                                <apex:facet name="stop">
                                                                    <apex:commandlink styleClass="arrowLink" onclick="changeTheValue('accountNumberInput','{!selectedAccount.AccountNumber}');" status="status11" reRender="AccountNumberSection" rendered="{!IF(AND(isEditAccount,lower(sfAccountChild.Bread_Winner__Account_Number__c)!=lower(selectedAccount.AccountNumber),NOT(ISBLANK(selectedAccount.AccountNumber))),'TRUE','FALSE')}">
                                                                        <span title="Copy this Account Number in the Salesforce to Xero" class="arrow">&#10140;</span>
                                                                    </apex:commandlink>
                                                                </apex:facet>
                                                            </apex:actionStatus>
                                                        </div>
                                                    </div>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <apex:inputField id="accountNumberInput" label="Account Number" value="{!sfAccountChild.Bread_Winner__Account_Number__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="AttentionToSection" rendered="{!$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__AttentionTo__c.createable}">
                                                    <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <label class="slds-form-element__label slds-p-top_none">Attention To</label>
                                                        <apex:inputField id="attentionToInput" label="Attention To" value="{!sfAccountChild.Bread_Winner__AttentionTo__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="TaxNumberSection" rendered="{!AND(!isFreePlan,isBusinessOrHigher,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__TaxNumber__c.createable)}">
                                                    <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <label class="slds-form-element__label slds-p-top_none">Xero {!if(SFOrgDefaultCurrency == 'AUD','Tax/VAT','Tax/GST')} Number</label>
                                                        <apex:inputField id="TaxNumberInput" label="Attention To" value="{!sfAccountChild.Bread_Winner__TaxNumber__c}" styleClass="slds-input" html-autofocus="false"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="DefaultTaxRateSection" rendered="{!AND(!isFreePlan,SpecialBusinessPlanOrHigher,Invoice_Type=='invoice')}">
                                                    <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <label class="slds-form-element__label slds-p-top_none">Default Sales Tax Rate</label>
                                                        <div class="slds-form-element__control">
                                                            <div class="slds-select_container">
                                                                <apex:selectList label="Default Sales Tax Rate" size="1" value="{!conDefaultTaxRate}" styleClass="slds-select" id="xeroOrgTaxRates">
                                                                    <apex:selectOptions value="{!xeroOrgTaxRates}"></apex:selectOptions>
                                                                </apex:selectList>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="slds-col slds-grid slds-wrap slds-p-vertical_xx-small" id="SalesTermsSection" rendered="{!AND(!isFreePlan,SpecialBusinessPlanOrHigher,Invoice_Type=='invoice')}">
                                                    <div class="slds-col_padded slds-large-size_7-of-12"/>
                                                    <div valign="top" class="slds-col_padded slds-large-size_4-of-12 slds-size_1-of-1">
                                                        <div class="slds-col">
                                                            <label class="slds-form-element__label slds-p-top_none">Sales Terms</label>
                                                            <div class="slds-form-element__control slds-grid slds-select_container">
                                                                <apex:inputtext styleClass="slds-input slds-size_1-of-5 slds-m-right_small" value="{!defaultDueDateDays}" style=" padding-left: 0.3rem; padding-right: 0.1rem; " />
                                                                <apex:selectList size="1" value="{!defaultDueDaysOption}" styleClass="slds-select" id="defaultDueDaysOptions"> 
                                                                    <apex:selectOptions value="{!defaultDueDaysOptions}"/>
                                                                </apex:selectList>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <script type="text/javascript">                                                    
                                                    function changeTheValue(fieldId,value) {
                                                        console.log('input[id$='+fieldId+']');
                                                        if(fieldId=='billingAddressInput'){
                                                            value = document.getElementById('{!JSENCODE($Component.theForm.billingAddress)}').value;
                                                            console.log('Value ::: '+value);
                                                            j$('textarea[id$='+fieldId+']').val(value);
                                                        }else{
                                                            console.log('Value ::: '+value);
                                                            j$('input[id$='+fieldId+']').val(value);
                                                        }
                                                    }
                                                    function ShowHideSection(sectionId){
                                                        var x = document.getElementById(sectionId);
                                                        console.log('Element');
                                                        console.log(x);
                                                        if (x.style.display === 'none') {
                                                            x.style.display = '';
                                                        } else {
                                                            x.style.display = 'none';
                                                        }
                                                    }
                                                </script>
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                            </div>
                            <div class="slds-text-align_center slds-m-top_medium slds-m-bottom_medium">
                                <apex:commandButton id="upsertBAC" disabled="{!isReadOnlyMode}" rendered="{!NOT(OR(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.createable), NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.createable))) || AND(isEditAccount, NOT(OR(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.updateable), NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.updateable))))}" value="{!IF(isEditAccount,'Save and Proceed to Invoice Creation','Create Xero Contact')}" onclick="createXeroAccount(); this.disabled=true; this.value='Creating...'; return false;" styleClass="slds-button slds-button_brand slds-m-right_small" status="assign-action-status" />
                                <apex:commandButton id="disabledCreateBAC" disabled="true" rendered="{!OR(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.createable), NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.createable))|| (AND(isEditAccount, OR(NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.updateable), NOT($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.updateable))))}" value="Create Xero Contact" styleClass="slds-button slds-button_brand slds-m-right_small" />
                                <apex:commandButton id="goBack" value="Cancel" action="{!goBack}" styleClass="slds-button slds-button_neutral" reRender="wholeBody" status="assign-action-status" oncomplete="HideStyleSheet();message();renderMoneyBagSVG();reRenderCheckSVG('#choosenStage1');reRenderCheckSVG('#choosenSupplier');"/>
                                <apex:actionFunction name="createXeroAccount" action="{!createXeroAccount}" />
                            </div>
                            <div align="center">
                                <apex:outputLabel style="font-style:italic;font-weight:bold;font-size:16px" rendered="{!isReadOnlyMode}">You are using Breadwinner in Xero Read Only Mode. While Breadwinner reads data from Xero, no changes will be made to Xero. Xero is in Read-Only mode and will not be altered in any way.</apex:outputLabel>
                            </div>
                        </apex:outputPanel>
                        <!--- Create or Edit BAC Section End -->

                        <!--- Search for BAC Section Start -->
                        <apex:outputPanel id="searchBACPanel" layout="block" rendered="{!showBACSearchPanel}">
                            <!-- Page Header Start -->
                            <div class="slds-page-header slds-m-bottom_medium" role="banner" style="background:#f7f9fb;">
                                <div class="slds-media slds-media_center">
                                    <div class="slds-media__figure">
                                        <span class="slds-icon_container slds-icon-standard-user" id="accountIcon">
                                            <svg class="slds-icon" aria-hidden="true">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/standard-sprite/svg/symbols.svg#account')}" />
                                            </svg>
                                        </span>
                                    </div>
                                    <div class="slds-media__body">
                                        <p class="slds-page-header__title slds-align-middle slds-truncate" title="Search Xero Contact">Search Xero Contact</p>
                                        <p class="slds-tesxt-body_small">Breadwinner â€¢ Xero </p>
                                    </div>
                                </div>
                            </div>
                            <!-- Page Header End  -->

                            <div class="slds-col_padded">
                                <apex:pagemessage summary="This functionality is in Beta. Please only use if recommended to do so by Breadwinner Support." severity="WARNING" strength="3"></apex:pagemessage>
                           </div>

                           <apex:outputPanel id="searchPanelContent" layout="block">
                                <div class="slds-col_padded slds-m-top_small">
                                    <h1 class="slds-section__title">If you're trying to create a {!Invoice_Type_Label} and are expecting to see an existing Xero Contact, you can search for that Xero Contact here.</h1>
                                    <div class="slds-form-element slds-m-vertical_small">
                                        <label class="slds-form-element__label" for="text-input-id-1">Please enter the part of that Xero Contact Name</label>
                                        <div class="slds-form-element__control">
                                            <apex:inputtext value="{!searchBAC}" styleClass="slds-input slds-size_2-of-3 slds-small-size_6-of-12 slds-medium-size_4-of-12 slds-large-size_3-of-12" style="min-width: 25rem;"/>
                                            <apex:commandButton value="Search" action="{!queryXeroContacts}" styleClass="slds-button slds-button_brand slds-m-left_medium slds-m-right_xx-small" status="assign-action-status" reRender="searchPanelContent" oncomplete="message();"/>
                                            <apex:commandButton value="Switch to the previous screen" action="{!goback}" status="assign-action-status" reRender="mainPanel" styleClass="slds-button slds-button_neutral" oncomplete="message();renderMoneyBagSVG();reRenderCheckSVG('#choosenStage1');"/>
                                        </div>
                                    </div>
                                    <div>
                                        <apex:pageMessages escape="false" />
                                    </div>
                                    <apex:actionFunction name="redirectToCreateBAC" action="{!next}" reRender="mainPanel" status="assign-action-status" oncomplete="reRenderAccountSVG();message();reRenderCheckSVG('#choosenStage2');reRenderCheckSVG('#selectBACStage');"/>
                                </div>
                                <apex:outputPanel rendered="{!showSearchedBACs}" layout="block">
                                    <script type="text/javascript">
                                        function createNewBAC(){
                                            document.getElementById('{!JSENCODE($Component.theForm.selectedXeroAccount)}').value = 'createNewXeroAccount';
                                        }
                                    </script>
                                    <apex:outputPanel rendered="{!searchedBACList.size == 0}">
                                        <div class="slds-col_padded slds-text-heading_small slds-m-top_large">No results found. Try to search using fewer characters. If you don't think the Xero Contact exists, you can <apex:commandLink onclick="createNewBAC();" status="assign-action-status" reRender="ntg" oncomplete="redirectToCreateBAC();"> create this {!Invoice_Type_Label} under a new Xero Contact.</apex:commandLink></div>
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!searchedBACList.size > 0}" id="BACListPanel">
                                        <div class="slds-col_padded">
                                            <div class="slds-section slds-m-top_large slds-m-bottom_medium">
                                                <h1 class="slds-section__title" style="padding: 0.3rem 0.7rem;background: #f7f9fb;">
                                                    Breadwinner found the following {!searchedBACList.size} Xero {!IF(searchedBACList.size == 1,'Contact','Contacts')} in Salesforce.
                                                </h1>
                                            </div>
                                            <apex:repeat value="{!searchedBACList}" var="xA">
                                                <apex:outputPanel rendered="{!xA.Bread_Winner__Reference_Id__c!=NULL}">
                                                    <div class="slds-card slds-m-bottom_large" style="background: none;">
                                                        <div class="slds-card__header slds-grid" style="margin: 0px;">
                                                            <h2 class="slds-card__header-title">
                                                                <apex:outputPanel title="{!xA.Bread_Winner__CompanyName__c}" rendered="{!$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.accessible}">
                                                                    <span class="slds-text-heading_small">Xero Contact: {!xA.Bread_Winner__CompanyName__c}</span>
                                                                </apex:outputPanel>
                                                            </h2>
                                                        </div>
                                                        <div class="slds-card__body" style="margin: 0px;">
                                                            <apex:outputPanel layout="block" styleClass="slds-grid slds-page-header__detail-row">
                                                                <div class="slds-page-header__detail-block slds-col">
                                                                    <apex:outputPanel layout="block" rendered="{!OR(AND(NOT(ISBLANK(xA.Bread_Winner__CompanyName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__StreetAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__StreetAddress__c.accessible),AND(OR(NOT(ISBLANK(xA.Bread_Winner__Region__c)),NOT(ISBLANK(xA.Bread_Winner__PostalCode__c))),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__City__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Region__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__PostalCode__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__Country__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Country__c.accessible))}">
                                                                        <p title="Company Information" class="slds-text-heading_label-normal slds-m-bottom_xx-small" style="font-weight:bold">Company Information</p>
                                                                        <div class="slds-text-body_regular">
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__CompanyName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__CompanyName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__CompanyName__c.accessible)}">
                                                                                {!xA.Bread_Winner__CompanyName__c}
                                                                                <br/>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__StreetAddress__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__StreetAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__StreetAddress__c.accessible)}">
                                                                                {!xA.Bread_Winner__StreetAddress__c}
                                                                                <br/>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__City__c} {!xA.Bread_Winner__Region__c} {!xA.Bread_Winner__PostalCode__c}" rendered="{!AND(OR(NOT(ISBLANK(xA.Bread_Winner__Region__c)),NOT(ISBLANK(xA.Bread_Winner__PostalCode__c))),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__City__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Region__c.accessible,$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__PostalCode__c.accessible)}">
                                                                                {!xA.City__c},&nbsp;{!xA.Region__c}&nbsp;{!xA.PostalCode__c}
                                                                                <br/>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__Country__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__Country__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Country__c.accessible)}">
                                                                                {!xA.Bread_Winner__Country__c}
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="slds-page-header__detail-block slds-col">
                                                                    <apex:outputPanel layout="block" rendered="{!OR(AND(NOT(ISBLANK(xA.Bread_Winner__AttentionTo__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__AttentionTo__c.accessible),AND(NOT(ISBLANK(xA.Bread_Winner__EmailAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__EmailAddress__c.accessible), AND(NOT(ISBLANK(xA.Bread_Winner__FirstName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__FirstName__c.accessible), AND(NOT(ISBLANK(xA.Bread_Winner__LastName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__LastName__c.accessible))}">
                                                                        <p class="slds-text-heading_label-normal slds-m-bottom_xx-small" style="font-weight:bold">Contact Info</p>
                                                                        <div class="slds-text-body_regular">
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__AttentionTo__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__AttentionTo__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__AttentionTo__c.accessible)}" >
                                                                                {!xA.Bread_Winner__AttentionTo__c}
                                                                                <br/>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__FirstName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__FirstName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__FirstName__c.accessible)}">
                                                                               {!xA.Bread_Winner__FirstName__c}
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__LastName__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__LastName__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__LastName__c.accessible)}">
                                                                               {!xA.Bread_Winner__LastName__c}<br/>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel title="{!xA.Bread_Winner__EmailAddress__c}" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__EmailAddress__c)),$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__EmailAddress__c.accessible)}">
                                                                                {!xA.Bread_Winner__EmailAddress__c}
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="slds-page-header__detail-block slds-col">
                                                                    <apex:outputPanel layout="block" rendered="{!AND(NOT(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c)),isMultiOrgEnabled)}">
                                                                        <p class="slds-text-heading_label-normal  slds-m-bottom_xx-small" style="font-weight:bold">Xero Org</p>
                                                                        <div class="slds-text-body_regular">
                                                                            <apex:outputPanel title="{!IF(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name), xA.Bread_Winner__Xero_Org_Name__c, appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name)}" rendered="{!$ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__Xero_Org_Name__c.accessible}">
                                                                                {!IF(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name), xA.Bread_Winner__Xero_Org_Name__c, appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Display_Name)}
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel rendered="{!NOT(ISBLANK(appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Logo_URL))}">
                                                                                <br/>
                                                                                <apex:image style="height: 40px" url="{!appConfigMap[xA.Bread_Winner__Xero_Org_ID__c].Logo_URL}" />
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                                <div class="slds-page-header__detail-block slds-col">
                                                                    <apex:outputPanel layout="block" styleClass="slds-page-header__detail-block" rendered="{!AND(isProfessionalOrHigher, OR(xeroOrgCurrencies.size>2, haveMultiCurrencyOrg))}" >
                                                                        <apex:variable var="list" value="{!''}{!CurrencyValues}" />
                                                                        <p class="slds-text-heading_label-normal  slds-m-bottom_xx-small" style="font-weight:bold">Currency</p>
                                                                        <div class="slds-text-body_regular">
                                                                            <apex:outputPanel title="{!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}" rendered="{!AND($ObjectType.Bread_Winner__Breadwinner_Account_Connection__c.fields.Bread_Winner__DefaultCurrency__c.accessible, ISBLANK(Opportunity_record_Currency))}">
                                                                                {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel rendered="{!NOT(ISBLANK(Opportunity_record_Currency))}">
                                                                                <apex:outputPanel style="color:red;" rendered="{! Opportunity_record_Currency != if(NOT(ISBLANK(xA.DefaultCurrency__c)),xA.DefaultCurrency__c,if(ISBLANK(xA.Xero_Org_ID__c), '', if(contains(list, xA.Xero_Org_ID__c),CurrencyValues[xA.Xero_Org_ID__c],'')))}">
                                                                                    {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel style="color:green;" rendered="{! Opportunity_record_Currency == if(NOT(ISBLANK(xA.DefaultCurrency__c)),xA.DefaultCurrency__c,if(ISBLANK(xA.Xero_Org_ID__c), '', if(contains(list, xA.Xero_Org_ID__c),CurrencyValues[xA.Xero_Org_ID__c],'')))}">
                                                                                    {!if(NOT(ISBLANK(xA.Bread_Winner__DefaultCurrency__c)),xA.Bread_Winner__DefaultCurrency__c,if(ISBLANK(xA.Bread_Winner__Xero_Org_ID__c), '', if(contains(list, xA.Bread_Winner__Xero_Org_ID__c),CurrencyValues[xA.Bread_Winner__Xero_Org_ID__c],'')))}
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <div class="slds-grid slds-m-horizontal_x-large slds-m-bottom_small">
                                                                <apex:outputPanel layout="block" rendered="{!NOT(ISBLANK(xA.Salesforce_Account__r.Name))}">
                                                                    <apex:outputPanel layout="block" rendered="{!selectedAccount.Id==xA.Bread_Winner__Salesforce_Account__c}">
                                                                        <div class="slds-m-top_x-small" style="font-weight: bold;">
                                                                            This Xero Contact has already been matched to the current Salesforce Account.
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" rendered="{!selectedAccount.Id!=xA.Bread_Winner__Salesforce_Account__c}">
                                                                        <div class="slds-m-top_x-small" style="font-weight: bold;">
                                                                            However, this Xero Contact has already been matched to the following Salesforce Account:
                                                                        </div>
                                                                        <div class="slds-m-top_x-small">
                                                                            <div class="slds-text-body_regular slds-truncate">
                                                                                <apex:outputPanel title="{!xA.Salesforce_Account__r.Name}" rendered="{!AND(NOT(ISBLANK(xA.Salesforce_Account__r.Name)),$ObjectType.Account.fields.Name.accessible)}">
                                                                                    {!xA.Salesforce_Account__r.Name}
                                                                                    <br/>
                                                                                </apex:outputPanel>
                                                                                
                                                                                <apex:outputPanel title="{!xA.Salesforce_Account__r.BillingStreet}" rendered="{!AND(NOT(ISBLANK(xA.Salesforce_Account__r.BillingStreet)),$ObjectType.Account.fields.BillingStreet.accessible)}">
                                                                                    {!xA.Salesforce_Account__r.BillingStreet}
                                                                                    <br/>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel title="{!xA.Salesforce_Account__r.BillingCity} {!xA.Salesforce_Account__r.BillingState} {!xA.Salesforce_Account__r.BillingPostalCode}" rendered="{!AND(OR(NOT(ISBLANK(xA.Salesforce_Account__r.BillingCity)),NOT(ISBLANK(xA.Salesforce_Account__r.BillingState)),NOT(ISBLANK(xA.Salesforce_Account__r.BillingPostalCode))),$ObjectType.Account.fields.BillingCity.accessible,$ObjectType.Account.fields.BillingState.accessible,$ObjectType.Account.fields.BillingPostalCode.accessible)}">
                                                                                    {!xA.Salesforce_Account__r.BillingCity}&nbsp;{!xA.Salesforce_Account__r.BillingState}&nbsp;{!xA.Salesforce_Account__r.BillingPostalCode}
                                                                                    <br/>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel title="{!xA.Salesforce_Account__r.BillingCountry}" rendered="{!AND(NOT(ISBLANK(xA.Salesforce_Account__r.BillingCountry)),$ObjectType.Account.fields.BillingCountry.accessible)}">
                                                                                    {!xA.Salesforce_Account__r.BillingCountry}
                                                                                </apex:outputPanel>
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" rendered="{!ISBLANK(xA.Salesforce_Account__r.Name)}">
                                                                    <div class="slds-m-top_x-small" style="font-weight: bold;">
                                                                        This Xero Contact has not yet been matched to any Salesforce Account.
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="slds-m-horizontal_x-large slds-m-bottom_small" style="text-align: left;font-weight: bold;">
                                                                <apex:commandLink value="I want to generate {!Invoice_Type_Label} for this Xero Contact" action="{!selectedXeroContactFromSearch}" reRender="optionsModal" onclick="showspinner('withouttext');" oncomplete="selectedXeroAccountFromSearch();">
                                                                    <apex:param name="contRefIdParam" value="{!xA.Bread_Winner__Reference_Id__c}"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </div>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- Options for Searched BAC Modal START -->
                                <apex:outputPanel layout="block" id="optionsModal">
                                    <div id="spinnerForReparent" class="slds-spinner_container" style="display: none;">
                                        <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                                            <div class="slds-spinner__dot-a"></div>
                                            <div class="slds-spinner__dot-b"></div>
                                        </div>
                                        <div class="slds-spinner-displaytext" role="alert"> 
                                            <apex:outputPanel id="reparentStatus">
                                                <apex:outputText rendered="{!isErrorOnReparenting}">Xero Contact <b>{!selectedBACFromSearch.Bread_Winner__CompanyName__c}</b> is associating with the Salesforce Account <b>{!selectedAccountName}</b>.
                                                </apex:outputText>
                                                <apex:outputText rendered="{!NOT(isErrorOnReparenting)}">
                                                    Please wait, redirecting to the create {!Invoice_Type_Label} page.
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </div>
                                    </div>
                                    <div id="modal" style="display:none;">
                                        <div class="slds-modal slds-modal_large slds-fade-in-open" aria-hidden="false" role="dialog">
                                            <div class="slds-modal__container">
                                                <div class="slds-modal__header slds-theme_info" style="background-color: rgba(84,105,141,.95);">
                                                    <button id="closeIcon" type="button" class="slds-button slds-button_icon-inverse slds-modal__close" onclick="closeModal();">
                                                        <svg aria-hidden="true" class="slds-button__icon slds-button__icon_large">
                                                            <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/action-sprite/svg/symbols.svg#close')}" ></use>
                                                        </svg>
                                                        <span class="slds-assistive-text">Close</span>
                                                    </button>
                                                    <h2 class="slds-text-heading_medium">You have {!IF(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name),'the following option','following options')}</h2>
                                                </div>
                                                <div class="slds-modal__content slds-p-around_medium">
                                                    <div class="slds-section slds-is-open">
                                                        <h3 class="slds-section-title_divider slds-m-top_medium" style="font-size: 1.03em; text-transform: none;background: #f7f9fb;">{!IF(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name),'Associate','Reparent')} the Xero Contact under the current Salesforce Account</h3>
                                                        <div class="slds-section__content slds-m-horizontal_small">
                                                            <apex:pageMessages escape="false" id="pmgReparenting"/>
                                                            <div class="slds-m-bottom_small">
                                                                The Xero Contact {!IF(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name),'is not associated with any Salesforce Account','might be associated with the wrong Salesforce Account')}. You can {!IF(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name),'associate','reparent')} the Xero Contact <b>{!selectedBACFromSearch.CompanyName__c}</b> to this Salesforce Account <b>{!selectedAccountName}</b>.
                                                            </div>
                                                            <div class="slds-m-bottom_small" style="display:{!IF(selectedBACFromSearch.Invoices__r.size==0,'none','')}">
                                                                <b>Note:</b> Please be aware that this will also bring over that Xero Contact's <b>{!selectedBACFromSearch.Invoices__r.size}</b> Invoices and associate them as well with this Salesforce Account.
                                                            </div>
                                                            <div class="slds-clearfix slds-m-bottom_small" style="display:{!IF(selectedBACFromSearch.Invoices__r.size==0,'none','')}">
                                                                <div class="slds-form-element slds-float_left" style="text-align:center;">
                                                                   <label class="slds-checkbox_toggle slds-grid">
                                                                       <apex:inputCheckbox value="{!removeInvOppOnReparent}"/>
                                                                       <span class="slds-checkbox_faux_container" aria-live="assertive">
                                                                           <span class="slds-checkbox_faux"></span>
                                                                       </span>
                                                                       <span class="slds-m-top_xx-small slds-m-left_x-small">Remove the link between the Xero Contact all Invoices and any Opportunities on the old Salesforce Account</span>
                                                                   </label>
                                                               </div>
                                                            </div>
                                                            <apex:commandLink value="Proceed to {!IF(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name),'associate','reparent')} this Xero Contact" action="{!associateBACFromSearchWithCurrentAccount}" onclick="showspinner('withtext');" style="font-weight: bold;" reRender="pmgReparenting,reparentStatus,scriptpanel" oncomplete="associateBACResult();"/>
                                                            <apex:actionfunction name="redirectToInvoicePage" action="{!next}"/>
                                                        </div>
                                                    </div>
                                                    <apex:outputPanel layout="block" rendered="{!NOT(ISBLANK(selectedBACFromSearch.Salesforce_Account__r.Name))}">
                                                        <div class="slds-section slds-is-open" id="mergesectiondivId" >
                                                            <h3 class="slds-section-title_divider slds-m-top_medium" style="font-size: 1.03em; text-transform: none;background: #f7f9fb;">Merge duplicate Salesforce Accounts</h3>
                                                            <div class="slds-section__content slds-m-horizontal_small">
                                                                <div class="slds-m-bottom_small">
                                                                    You might have duplicate Salesforce Accounts, and need to merge them. You can do this with the help of Salesforce Account Merge wizard.
                                                                </div>
                                                                <div class="slds-m-bottom_small">
                                                                    <b>Note:</b> After merging, you'll need to return to the merged Account and start creating the {!Invoice_Type_Label} again.
                                                                </div>
                                                                <apex:outputLink value="/merge/accmergewizard.jsp?goNext=Next&cid={!selectedAccount.Id}&cid={!selectedBACFromSearch.Bread_Winner__Salesforce_Account__c}" target="_blank" rendered="{!AND(NOT(isLightning),isBreadwinnerAdministrator)}" style="font-weight: bold;">Go to Salesforce Account Merge wizard</apex:outputLink>
                                                                <apex:outputLink value="/merge/accmergewizard.jsp?goNext=Next&cid={!selectedAccount.Id}&cid={!selectedBACFromSearch.Bread_Winner__Salesforce_Account__c}" target="_top" rendered="{!AND(isLightning,isBreadwinnerAdministrator)}" style="font-weight: bold;">Go to Salesforce Account Merge wizard</apex:outputLink>
                                                                <apex:commandlink value="Go to Salesforce Account Merge wizard" rendered="{!NOT(isBreadwinnerAdministrator)}" style="font-weight: bold;color: grey;cursor: not-allowed;" id="mergingDisabledlink"/>
                                                            </div>
                                                        </div>
                                                        <div class="slds-section slds-is-open" id="createInvsectiondivId" >
                                                            <h3 class="slds-section-title_divider slds-m-top_medium" style="font-size: 1.03em; text-transform: none;background: #f7f9fb;">Create {!Invoice_Type_Label} under the Salesforce Account <b>{!selectedBACFromSearch.Salesforce_Account__r.Name}</b></h3>
                                                            <div class="slds-section__content slds-m-horizontal_small">
                                                                You might just want to create {!Invoice_Type_Label} under the Salesforce Account <b>{!selectedBACFromSearch.Salesforce_Account__r.Name}</b>, rather than the Salesforce Account <b>{!selectedAccountName}</b>. If that's the case, you can go to the Salesforce Account&nbsp;<apex:outputLink value="/{!selectedBACFromSearch.Bread_Winner__Salesforce_Account__c}" target="_blank" rendered="{!NOT(isLightning)}" style="font-weight: bold;">{!selectedBACFromSearch.Salesforce_Account__r.Name}</apex:outputLink><apex:outputLink value="/{!selectedBACFromSearch.Bread_Winner__Salesforce_Account__c}" rendered="{!isLightning}" style="font-weight: bold;">{!selectedBACFromSearch.Salesforce_Account__r.Name}</apex:outputLink>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:actionfunction name="redirectToInvoicePageFromSearch" action="{!next}"/>
                                                    <apex:outputPanel id="scriptpanel">
                                                        <script type="text/javascript">
                                                            var j$ = jQuery.noConflict();
                                                            function associateBACResult(){
                                                                if({!isErrorOnReparenting}==true){
                                                                    message();
                                                                    hidespinner('withtext');
                                                                }
                                                                else{
                                                                    setTimeout(function(){                                                    
                                                                        pushSelectedXeroAccount('{!JSENCODE(selectedBACFromSearch.Reference_Id__c)}');
                                                                        redirectToInvoicePage();
                                                                    },5000);
                                                                }
                                                            }
                                                            function selectedXeroAccountFromSearch(){
                                                                if({!isSelectedAccountBAC}){                                                    
                                                                    redirectToInvoicePageFromSearch();
                                                                }
                                                                else{
                                                                    showModal();
                                                                    message();
                                                                    hidespinner('withouttext');
                                                                }
                                                            }
                                                        </script>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-backdrop slds-backdrop_open" id="backdrop"></div>
                                    </div>
                                </apex:outputPanel>
                                <!-- Options for Searched BAC Modal END -->
                           </apex:outputPanel>
                        </apex:outputPanel>
                        <!--- Search for BAC Section End -->
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!OR(showInvoicePanel, AND(showInvoicePanel, POforBusinessOrg, NOT(Suppliers.size>1)))}">
                        <apex:pageMessages rendered="{!!Invalidfields}"></apex:pageMessages>
                    </apex:outputPanel>
                </apex:form>
            </apex:outputPanel>
            </div>
        </body>
        <script type="text/javascript">
            try{
              if({!isUnauthorizedEndpoint}===true){
                var binding = new XMLHttpRequest();
                var host = "{!LEFT($Api.Enterprise_Server_URL_350, FIND('/services',$Api.Enterprise_Server_URL_350))}";
                var request = 
                    '<?xml version="1.0" encoding="UTF-8"?><env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header><SessionHeader xmlns="http://soap.sforce.com/2006/04/metadata"><sessionId>{!$Api.Session_ID}</sessionId></SessionHeader></env:Header><env:Body><upsertMetadata xmlns="http://soap.sforce.com/2006/04/metadata"><metadata xsi:type="RemoteSiteSetting"><fullName>Breadwinner_Xero_MyServer</fullName><description>Required to use Metadata API, created by Breadwinner</description><disableProtocolSecurity>false</disableProtocolSecurity><isActive>true</isActive><url>{!remoteSiteURL}</url></metadata></upsertMetadata></env:Body></env:Envelope>';
                
                binding.open('POST', host+'services/Soap/m/35.0');
                binding.setRequestHeader('SOAPAction','""');
                binding.setRequestHeader('Content-Type', 'text/xml');
                binding.onreadystatechange =
                    function() {
                    if(this.readyState==4) {
                        var parser = new DOMParser();
                        var doc  = parser.parseFromString(this.response, 'application/xml');
                        var errors = doc.getElementsByTagName('errors');
                        console.log(errors);
                    }
                }
                binding.send(request);
                deleteMDfield();
              }
            }
            catch(error){
              console.log(error);
            }
        </script>
    </html>
</apex:page>